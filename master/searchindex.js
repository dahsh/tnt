Search.setIndex({"docnames": ["checkpointing", "distributed", "examples", "framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.EarlyStopping", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "overview", "utils/generated/torchtnt.utils.data.AbstractRandomDataset", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher", "utils/generated/torchtnt.utils.data.InOrderIterator", "utils/generated/torchtnt.utils.data.MultiDataLoader", "utils/generated/torchtnt.utils.data.MultiIterator", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator", "utils/generated/torchtnt.utils.data.RoundRobinIterator", "utils/generated/torchtnt.utils.device.copy_data_to_device", "utils/generated/torchtnt.utils.device.get_device_from_env", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats", "utils/generated/torchtnt.utils.device.record_data_in_stream", "utils/generated/torchtnt.utils.device.set_float32_precision", "utils/generated/torchtnt.utils.distributed.PGWrapper", "utils/generated/torchtnt.utils.distributed.all_gather_tensors", "utils/generated/torchtnt.utils.distributed.barrier", "utils/generated/torchtnt.utils.distributed.destroy_process_group", "utils/generated/torchtnt.utils.distributed.get_file_init_method", "utils/generated/torchtnt.utils.distributed.get_global_rank", "utils/generated/torchtnt.utils.distributed.get_local_rank", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method", "utils/generated/torchtnt.utils.distributed.get_world_size", "utils/generated/torchtnt.utils.distributed.rank_zero_fn", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm", "utils/generated/torchtnt.utils.distributed.spawn_multi_process", "utils/generated/torchtnt.utils.distributed.sync_bool", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker", "utils/generated/torchtnt.utils.env.init_from_env", "utils/generated/torchtnt.utils.env.seed", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode", "utils/generated/torchtnt.utils.fsspec.get_filesystem", "utils/generated/torchtnt.utils.loggers.CSVLogger", "utils/generated/torchtnt.utils.loggers.FileLogger", "utils/generated/torchtnt.utils.loggers.InMemoryLogger", "utils/generated/torchtnt.utils.loggers.JSONLogger", "utils/generated/torchtnt.utils.loggers.MetricLogger", "utils/generated/torchtnt.utils.loggers.StdoutLogger", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger", "utils/generated/torchtnt.utils.memory.RSSProfiler", "utils/generated/torchtnt.utils.memory.measure_rss_deltas", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "utils/generated/torchtnt.utils.misc.days_to_secs", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats", "utils/generated/torchtnt.utils.module_summary.ModuleSummary", "utils/generated/torchtnt.utils.module_summary.get_module_summary", "utils/generated/torchtnt.utils.module_summary.get_summary_table", "utils/generated/torchtnt.utils.module_summary.prune_module_summary", "utils/generated/torchtnt.utils.oom.attach_oom_observer", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error", "utils/generated/torchtnt.utils.oom.log_memory_snapshot", "utils/generated/torchtnt.utils.optimizer.init_optim_state", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp", "utils/generated/torchtnt.utils.prepare_module.prepare_module", "utils/generated/torchtnt.utils.progress.Progress", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn", "utils/generated/torchtnt.utils.stateful.MultiStateful", "utils/generated/torchtnt.utils.stateful.Stateful", "utils/generated/torchtnt.utils.swa.AveragedModel", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config", "utils/generated/torchtnt.utils.test_utils.is_asan", "utils/generated/torchtnt.utils.test_utils.is_tsan", "utils/generated/torchtnt.utils.test_utils.skip_if_asan", "utils/generated/torchtnt.utils.timer.BoundedTimer", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer", "utils/generated/torchtnt.utils.timer.Timer", "utils/generated/torchtnt.utils.timer.TimerProtocol", "utils/generated/torchtnt.utils.timer.get_durations_histogram", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram", "utils/generated/torchtnt.utils.timer.get_timer_summary", "utils/generated/torchtnt.utils.timer.log_elapsed_time", "utils/generated/torchtnt.utils.tqdm.close_progress_bar", "utils/generated/torchtnt.utils.tqdm.create_progress_bar", "utils/generated/torchtnt.utils.tqdm.update_progress_bar", "utils/generated/torchtnt.utils.version.get_python_version", "utils/generated/torchtnt.utils.version.get_torch_version", "utils/generated/torchtnt.utils.version.is_windows", "utils/utils"], "filenames": ["checkpointing.rst", "distributed.rst", "examples.rst", "framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.EarlyStopping.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TimeLimitInterrupter.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "overview.rst", "utils/generated/torchtnt.utils.data.AbstractRandomDataset.rst", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator.rst", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher.rst", "utils/generated/torchtnt.utils.data.InOrderIterator.rst", "utils/generated/torchtnt.utils.data.MultiDataLoader.rst", "utils/generated/torchtnt.utils.data.MultiIterator.rst", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator.rst", "utils/generated/torchtnt.utils.data.RoundRobinIterator.rst", "utils/generated/torchtnt.utils.device.copy_data_to_device.rst", "utils/generated/torchtnt.utils.device.get_device_from_env.rst", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats.rst", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats.rst", "utils/generated/torchtnt.utils.device.record_data_in_stream.rst", "utils/generated/torchtnt.utils.device.set_float32_precision.rst", "utils/generated/torchtnt.utils.distributed.PGWrapper.rst", "utils/generated/torchtnt.utils.distributed.all_gather_tensors.rst", "utils/generated/torchtnt.utils.distributed.barrier.rst", "utils/generated/torchtnt.utils.distributed.destroy_process_group.rst", "utils/generated/torchtnt.utils.distributed.get_file_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_global_rank.rst", "utils/generated/torchtnt.utils.distributed.get_local_rank.rst", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device.rst", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_world_size.rst", "utils/generated/torchtnt.utils.distributed.rank_zero_fn.rst", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm.rst", "utils/generated/torchtnt.utils.distributed.spawn_multi_process.rst", "utils/generated/torchtnt.utils.distributed.sync_bool.rst", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker.rst", "utils/generated/torchtnt.utils.env.init_from_env.rst", "utils/generated/torchtnt.utils.env.seed.rst", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode.rst", "utils/generated/torchtnt.utils.fsspec.get_filesystem.rst", "utils/generated/torchtnt.utils.loggers.CSVLogger.rst", "utils/generated/torchtnt.utils.loggers.FileLogger.rst", "utils/generated/torchtnt.utils.loggers.InMemoryLogger.rst", "utils/generated/torchtnt.utils.loggers.JSONLogger.rst", "utils/generated/torchtnt.utils.loggers.MetricLogger.rst", "utils/generated/torchtnt.utils.loggers.StdoutLogger.rst", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger.rst", "utils/generated/torchtnt.utils.memory.RSSProfiler.rst", "utils/generated/torchtnt.utils.memory.measure_rss_deltas.rst", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler.rst", "utils/generated/torchtnt.utils.misc.days_to_secs.rst", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats.rst", "utils/generated/torchtnt.utils.module_summary.ModuleSummary.rst", "utils/generated/torchtnt.utils.module_summary.get_module_summary.rst", "utils/generated/torchtnt.utils.module_summary.get_summary_table.rst", "utils/generated/torchtnt.utils.module_summary.prune_module_summary.rst", "utils/generated/torchtnt.utils.oom.attach_oom_observer.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error.rst", "utils/generated/torchtnt.utils.oom.log_memory_snapshot.rst", "utils/generated/torchtnt.utils.optimizer.init_optim_state.rst", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype.rst", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_module.rst", "utils/generated/torchtnt.utils.progress.Progress.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn.rst", "utils/generated/torchtnt.utils.stateful.MultiStateful.rst", "utils/generated/torchtnt.utils.stateful.Stateful.rst", "utils/generated/torchtnt.utils.swa.AveragedModel.rst", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config.rst", "utils/generated/torchtnt.utils.test_utils.is_asan.rst", "utils/generated/torchtnt.utils.test_utils.is_tsan.rst", "utils/generated/torchtnt.utils.test_utils.skip_if_asan.rst", "utils/generated/torchtnt.utils.timer.BoundedTimer.rst", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer.rst", "utils/generated/torchtnt.utils.timer.Timer.rst", "utils/generated/torchtnt.utils.timer.TimerProtocol.rst", "utils/generated/torchtnt.utils.timer.get_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table.rst", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram.rst", "utils/generated/torchtnt.utils.timer.get_timer_summary.rst", "utils/generated/torchtnt.utils.timer.log_elapsed_time.rst", "utils/generated/torchtnt.utils.tqdm.close_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.create_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.update_progress_bar.rst", "utils/generated/torchtnt.utils.version.get_python_version.rst", "utils/generated/torchtnt.utils.version.get_torch_version.rst", "utils/generated/torchtnt.utils.version.is_windows.rst", "utils/utils.rst"], "titles": ["Checkpointing", "Distributed training", "Examples", "AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "EarlyStopping", "GarbageCollector", "IterationTimeLogger", "Lambda", "LearningRateMonitor", "MemorySnapshot", "ModuleSummary", "PyTorchProfiler", "SystemResourcesMonitor", "TQDMProgressBar", "TensorBoardParameterMonitor", "TimeLimitInterrupter", "TorchSnapshotSaver", "TrainProgressMonitor", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Overview", "torchtnt.utils.data.AbstractRandomDataset", "torchtnt.utils.data.AllDatasetBatchesIterator", "torchtnt.utils.data.CudaDataPrefetcher", "torchtnt.utils.data.InOrderIterator", "torchtnt.utils.data.MultiDataLoader", "torchtnt.utils.data.MultiIterator", "torchtnt.utils.data.RandomizedBatchSamplerIterator", "torchtnt.utils.data.RoundRobinIterator", "torchtnt.utils.device.copy_data_to_device", "torchtnt.utils.device.get_device_from_env", "torchtnt.utils.device.get_nvidia_smi_gpu_stats", "torchtnt.utils.device.get_psutil_cpu_stats", "torchtnt.utils.device.record_data_in_stream", "torchtnt.utils.device.set_float32_precision", "torchtnt.utils.distributed.PGWrapper", "torchtnt.utils.distributed.all_gather_tensors", "torchtnt.utils.distributed.barrier", "torchtnt.utils.distributed.destroy_process_group", "torchtnt.utils.distributed.get_file_init_method", "torchtnt.utils.distributed.get_global_rank", "torchtnt.utils.distributed.get_local_rank", "torchtnt.utils.distributed.get_process_group_backend_from_device", "torchtnt.utils.distributed.get_tcp_init_method", "torchtnt.utils.distributed.get_world_size", "torchtnt.utils.distributed.rank_zero_fn", "torchtnt.utils.distributed.revert_sync_batchnorm", "torchtnt.utils.distributed.spawn_multi_process", "torchtnt.utils.distributed.sync_bool", "torchtnt.utils.early_stop_checker.EarlyStopChecker", "torchtnt.utils.env.init_from_env", "torchtnt.utils.env.seed", "torchtnt.utils.flops.FlopTensorDispatchMode", "torchtnt.utils.fsspec.get_filesystem", "torchtnt.utils.loggers.CSVLogger", "torchtnt.utils.loggers.FileLogger", "torchtnt.utils.loggers.InMemoryLogger", "torchtnt.utils.loggers.JSONLogger", "torchtnt.utils.loggers.MetricLogger", "torchtnt.utils.loggers.StdoutLogger", "torchtnt.utils.loggers.TensorBoardLogger", "torchtnt.utils.memory.RSSProfiler", "torchtnt.utils.memory.measure_rss_deltas", "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "torchtnt.utils.misc.days_to_secs", "torchtnt.utils.misc.transfer_batch_norm_stats", "torchtnt.utils.module_summary.ModuleSummary", "torchtnt.utils.module_summary.get_module_summary", "torchtnt.utils.module_summary.get_summary_table", "torchtnt.utils.module_summary.prune_module_summary", "torchtnt.utils.oom.attach_oom_observer", "torchtnt.utils.oom.is_out_of_cpu_memory", "torchtnt.utils.oom.is_out_of_cuda_memory", "torchtnt.utils.oom.is_out_of_memory_error", "torchtnt.utils.oom.log_memory_snapshot", "torchtnt.utils.optimizer.init_optim_state", "torchtnt.utils.precision.convert_precision_str_to_dtype", "torchtnt.utils.prepare_module.DDPStrategy", "torchtnt.utils.prepare_module.FSDPStrategy", "torchtnt.utils.prepare_module.convert_str_to_strategy", "torchtnt.utils.prepare_module.prepare_ddp", "torchtnt.utils.prepare_module.prepare_fsdp", "torchtnt.utils.prepare_module.prepare_module", "torchtnt.utils.progress.Progress", "torchtnt.utils.progress.estimated_steps_in_epoch", "torchtnt.utils.progress.estimated_steps_in_fit", "torchtnt.utils.progress.estimated_steps_in_loop", "torchtnt.utils.rank_zero_log.rank_zero_critical", "torchtnt.utils.rank_zero_log.rank_zero_debug", "torchtnt.utils.rank_zero_log.rank_zero_error", "torchtnt.utils.rank_zero_log.rank_zero_info", "torchtnt.utils.rank_zero_log.rank_zero_print", "torchtnt.utils.rank_zero_log.rank_zero_warn", "torchtnt.utils.stateful.MultiStateful", "torchtnt.utils.stateful.Stateful", "torchtnt.utils.swa.AveragedModel", "torchtnt.utils.test_utils.get_pet_launch_config", "torchtnt.utils.test_utils.is_asan", "torchtnt.utils.test_utils.is_tsan", "torchtnt.utils.test_utils.skip_if_asan", "torchtnt.utils.timer.BoundedTimer", "torchtnt.utils.timer.FullSyncPeriodicTimer", "torchtnt.utils.timer.Timer", "torchtnt.utils.timer.TimerProtocol", "torchtnt.utils.timer.get_durations_histogram", "torchtnt.utils.timer.get_recorded_durations_table", "torchtnt.utils.timer.get_synced_durations_histogram", "torchtnt.utils.timer.get_synced_timer_histogram", "torchtnt.utils.timer.get_timer_summary", "torchtnt.utils.timer.log_elapsed_time", "torchtnt.utils.tqdm.close_progress_bar", "torchtnt.utils.tqdm.create_progress_bar", "torchtnt.utils.tqdm.update_progress_bar", "torchtnt.utils.version.get_python_version", "torchtnt.utils.version.get_torch_version", "torchtnt.utils.version.is_windows", "Utils"], "terms": {"torchtnt": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27], "offer": [0, 1, 3, 4, 20, 25, 27], "via": [0, 35], "torchsnapshotsav": 0, "which": [0, 1, 3, 4, 5, 6, 10, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 30, 32, 36, 40, 41, 53, 55, 56, 69, 70, 87, 88, 89, 107, 109, 115], "us": [0, 1, 2, 3, 4, 5, 6, 8, 13, 14, 15, 19, 20, 22, 23, 24, 25, 27, 30, 34, 39, 40, 41, 42, 44, 46, 47, 48, 50, 51, 52, 54, 55, 57, 58, 60, 67, 74, 82, 86, 89, 102, 113, 114, 118, 123], "torchsnapshot": [0, 20], "under": [0, 20, 25], "hood": 0, "modul": [0, 1, 3, 5, 6, 14, 18, 22, 24, 25, 26, 27, 53, 58, 59, 72, 73, 74, 76, 85, 87, 88, 89, 100, 102], "nn": [0, 1, 3, 25, 27, 53, 87, 88, 100], "linear": [0, 1, 27, 53, 87, 88], "input_dim": [0, 1], "1": [0, 1, 6, 8, 9, 10, 17, 19, 27, 29, 30, 31, 34, 35, 51, 52, 55, 56, 58, 59, 66, 74, 75, 76, 87, 88, 121], "unit": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 26, 27], "myunit": [0, 11, 25, 27], "tss": 0, "dirpath": [0, 20], "your_dirpath_her": 0, "save_every_n_train_step": [0, 20], "100": [0, 28, 53, 61, 64, 111, 113, 114], "save_every_n_epoch": [0, 20], "2": [0, 3, 19, 29, 30, 31, 34, 35, 55, 58, 66, 75], "load": [0, 1, 20, 30, 82, 101], "latest": [0, 26], "exist": [0, 20, 82], "latest_checkpoint_dir": 0, "restore_from_latest": 0, "train_dataload": [0, 4, 6, 20, 24, 27, 92], "dataload": [0, 3, 5, 6, 11, 20, 22, 23, 24, 25, 27, 29, 30, 31, 32, 33, 34, 35, 70, 91, 93, 118], "train": [0, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 67, 70, 92, 103, 108, 123], "callback": [0, 1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 26], "There": [0, 20, 27], "built": [0, 27], "support": [0, 3, 29, 31, 32, 33, 35, 37, 55, 74], "save": [0, 7, 13, 20, 70, 77, 81, 100, 101], "distribut": [0, 8, 9, 17, 20, 26, 27, 37, 57, 67, 86, 103], "ddp": [0, 1, 3, 27, 84, 87, 89], "fsdp": [0, 1, 3, 20, 27, 88, 89, 102], "The": [0, 1, 2, 3, 5, 6, 7, 8, 9, 14, 19, 20, 22, 24, 25, 27, 28, 36, 40, 41, 46, 53, 55, 57, 59, 66, 68, 69, 70, 74, 76, 77, 81, 102, 103, 107, 111, 113, 114, 118], "state": [0, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 25, 26, 27, 52, 82], "dict": [0, 14, 20, 29, 31, 32, 38, 39, 68, 82, 100, 111, 112, 113, 114], "type": [0, 14, 20, 25, 27, 28, 32, 38, 39, 43, 52, 57, 73], "can": [0, 1, 2, 3, 4, 5, 6, 9, 19, 20, 22, 23, 24, 25, 26, 27, 30, 31, 33, 34, 35, 52, 67, 70, 123], "specifi": [0, 13, 17, 19, 25, 27, 55, 70, 86, 102, 118], "fsdpstrategi": [0, 1, 3, 86, 88], "s": [0, 2, 3, 5, 6, 9, 20, 22, 24, 25, 32, 55, 57, 74, 114], "state_dict_typ": [0, 85], "argument": [0, 1, 3, 5, 6, 22, 24, 36, 67, 74, 102], "like": [0, 1, 3, 20, 33, 40, 82, 102], "so": [0, 1, 3, 26, 66, 70, 118], "fsdp_strategi": [0, 1], "set": [0, 1, 5, 6, 16, 20, 22, 24, 29, 34, 37, 41, 48, 56, 57, 58, 66, 68, 69, 70, 75, 81, 87, 88, 89, 107, 109, 116], "sharded_state_dict": 0, "prepare_fsdp": [0, 1], "strategi": [0, 1, 3, 27, 35, 84, 85, 86, 87, 88, 89], "Or": 0, "you": [0, 1, 3, 20, 25, 26, 74], "manual": [0, 27], "thi": [0, 1, 3, 4, 6, 7, 8, 9, 13, 19, 20, 21, 25, 28, 29, 30, 31, 32, 34, 35, 37, 40, 43, 44, 50, 52, 53, 55, 56, 57, 58, 66, 67, 73, 77, 81, 82, 89, 102, 107], "set_state_dict_typ": [0, 20], "statedicttyp": [0, 85], "when": [0, 1, 2, 3, 4, 7, 11, 13, 14, 19, 20, 21, 23, 29, 30, 40, 44, 56, 60, 68, 69, 77, 107], "your": [0, 1, 4, 13, 25], "pass": [0, 1, 3, 4, 20, 25, 27, 32, 36, 61, 67, 74, 83, 86, 102, 111], "restoreopt": [0, 20], "avoid": [0, 40, 58, 108], "optim": [0, 3, 5, 6, 12, 22, 24, 25, 26, 27, 100, 102], "learn": [0, 3, 12, 25], "rate": [0, 3, 12, 17, 25], "schedul": [0, 3, 12, 25], "your_unit": 0, "restore_opt": [0, 20], "restore_optim": 0, "fals": [0, 1, 32, 61, 64, 70, 75, 84, 85, 89, 102, 109], "restore_lr_schedul": 0, "sometim": 0, "mai": [0, 5, 6, 20, 22, 24, 43, 82, 100], "help": [0, 1, 21], "keep": [0, 14, 20, 70, 76], "track": [0, 5, 6, 12, 19, 22, 24, 70, 90], "how": [0, 2, 3, 6, 19, 25, 29, 31, 32, 33, 34, 35], "perform": [0, 3, 5, 6, 9, 20, 22, 24, 25, 107, 109], "done": [0, 5, 6, 22, 24, 29, 35, 108], "bestcheckpointconfig": [0, 20], "param": [0, 3, 20, 84, 89, 102], "best_checkpoint_config": [0, 20], "monitored_metr": 0, "train_loss": [0, 27], "mode": [0, 5, 6, 22, 24, 56, 106], "min": [0, 56], "By": [0, 7, 9, 20, 31, 34, 40], "monitor": [0, 8, 20, 27, 56], "expect": [0, 1], "trainunit": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 24, 27], "have": [0, 3, 20, 25, 27, 43, 53, 66, 100], "attribut": [0, 8, 20, 28, 56, 61, 62, 63, 64, 67, 73, 84, 85, 90, 102, 107, 109, 110], "time": [0, 5, 6, 9, 10, 19, 20, 22, 23, 24, 61, 71, 73, 82, 107, 108, 109, 110, 112, 116], "cast": 0, "valu": [0, 3, 8, 20, 29, 31, 32, 33, 34, 35, 38, 39, 43, 54, 55, 57, 58, 66, 68, 74, 93, 111, 113, 114], "float": [0, 8, 20, 27, 38, 39, 55, 56, 91, 102, 111, 112, 113, 114], "append": [0, 69, 81], "path": [0, 7, 20, 60, 61, 62, 64, 67], "name": [0, 4, 7, 14, 20, 29, 31, 32, 33, 34, 35, 61, 66, 68, 73, 111, 113, 114, 116], "comput": [0, 3, 27, 30, 111, 113, 114], "kept": [0, 20, 107], "up": [0, 9, 23, 89], "date": 0, "appropri": [0, 20, 27, 37, 60], "user": [0, 1, 3, 13, 15, 20, 23, 25, 27, 30, 70, 102], "later": 0, "restore_from_best": 0, "metric_nam": 0, "If": [0, 1, 3, 8, 14, 19, 20, 25, 26, 37, 38, 44, 46, 50, 53, 55, 56, 57, 58, 67, 70, 74, 76, 81, 92, 102, 107, 109, 111, 113, 114, 115, 116], "d": [0, 53], "valid": [0, 20], "sai": 0, "loss": [0, 3, 25, 27, 66], "after": [0, 3, 4, 6, 7, 8, 9, 10, 13, 15, 17, 18, 19, 20, 21, 23, 25, 27, 34, 56, 66, 67, 82, 107, 109], "each": [0, 3, 7, 9, 11, 12, 20, 23, 25, 28, 34, 43, 66, 111, 113, 114], "eval": [0, 3, 4, 5, 6, 9, 10, 11, 13, 15, 16, 17, 20, 22, 23, 25, 27, 92], "epoch": [0, 3, 4, 5, 6, 8, 11, 12, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 91, 92, 93, 118], "dure": [0, 3, 4, 5, 6, 7, 11, 13, 20, 22, 23, 24, 90], "fit": [0, 3, 4, 20, 23, 25, 26, 27, 92], "save_every_n_eval_epoch": [0, 20], "flag": [0, 3, 20, 89], "instead": [0, 20, 47, 51, 53], "eval_loss": 0, "And": 0, "onli": [0, 3, 8, 17, 20, 23, 37, 40, 52, 55, 57, 61, 62, 64, 67, 74, 77, 81, 82, 94, 95, 96, 97, 98, 99, 100, 102], "top": [0, 20, 26, 27], "three": [0, 25, 27, 29], "keep_last_n_checkpoint": [0, 20], "3": [0, 23, 29, 31, 34, 35, 55, 59, 120], "core": [1, 3, 25], "tnt": [1, 2, 26, 27], "framework": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 123], "make": [1, 9, 13, 26, 55, 66], "assumpt": 1, "about": [1, 3, 23, 25, 40], "devic": [1, 3, 26, 27, 30, 49, 53, 57, 77, 81, 84, 87, 88, 89, 102], "handl": [1, 3, 27, 60], "configur": [1, 3, 9, 20], "own": [1, 4], "As": [1, 9, 40], "conveni": [1, 3, 9, 25, 57, 90], "autounit": [1, 26, 27], "who": [1, 3, 27], "prefer": [1, 27], "automat": [1, 3, 9, 27, 50, 102], "provid": [1, 7, 19, 20, 28, 31, 32, 33, 34, 55, 81], "checkpoint": [1, 3, 4, 20, 26, 27, 82, 89, 90, 101], "model": [1, 2, 3, 4, 9, 13, 20, 25, 57, 59, 70, 72, 102], "ar": [1, 3, 4, 19, 20, 25, 26, 27, 29, 31, 32, 33, 34, 35, 43, 55, 61, 69, 70, 74, 76, 77, 81, 82, 102, 106, 111, 113, 114, 123], "evalunit": [1, 3, 4, 5, 6, 7, 9, 10, 11, 13, 14, 15, 16, 17, 20, 27], "predictunit": [1, 3, 4, 7, 9, 10, 11, 13, 14, 15, 16, 17, 20, 22, 27], "interfac": [1, 3, 7, 25, 27, 101], "initi": [1, 3, 13, 17, 20, 42, 44, 45, 46, 47, 50, 51, 55, 57, 59, 67, 68, 69, 82, 103], "cuda": [1, 5, 6, 16, 22, 24, 27, 30, 37, 40, 53, 77, 79, 81, 87, 88, 107, 109, 116], "applic": [1, 9, 20, 57], "along": [1, 111, 113, 114], "global": [1, 19, 44, 45, 46, 50, 52, 57, 58, 113, 114], "process": [1, 7, 9, 19, 20, 39, 42, 43, 44, 45, 49, 50, 54, 55, 57, 67, 103, 108, 113, 114], "group": [1, 12, 19, 20, 43, 44, 45, 49, 55, 57, 67, 113, 114], "from": [1, 3, 4, 5, 6, 11, 14, 20, 22, 24, 25, 26, 27, 29, 31, 33, 34, 38, 40, 43, 49, 52, 57, 59, 63, 66, 67, 71, 82, 94, 95, 96, 97, 98, 99, 103, 108, 111, 113, 118], "torch": [1, 3, 5, 6, 10, 15, 18, 20, 22, 24, 25, 27, 29, 30, 31, 34, 35, 36, 37, 38, 40, 41, 44, 47, 51, 53, 55, 57, 58, 59, 83, 87, 88, 89, 102, 103, 107, 109], "we": [1, 4, 9, 27, 30, 40, 74, 100, 106], "function": [1, 3, 4, 11, 14, 25, 32, 33, 36, 37, 43, 44, 46, 49, 50, 52, 53, 54, 55, 57, 58, 74, 77, 82, 98, 103, 112], "init_from_env": 1, "work": [1, 43, 82], "torchelast": 1, "should": [1, 3, 4, 6, 7, 19, 20, 25, 28, 30, 36, 52, 53, 55, 56, 67, 107, 111, 113, 114], "invok": [1, 27, 44], "begin": [1, 21, 57], "script": [1, 13, 57], "simpli": 1, "wrap": [1, 44, 52, 87, 88, 102], "around": [1, 26, 27, 42], "move": [1, 10, 27, 30, 31, 87, 88, 89], "device_id": 1, "index": [1, 33, 37], "distributeddataparallel": [1, 84, 87], "also": [1, 3, 20, 26, 27, 32, 33, 37], "prepare_ddp": 1, "assist": 1, "either": [1, 3, 10, 12, 16, 18, 19, 21, 25], "string": [1, 3, 7, 19, 75, 83, 86, 89], "my_auto_unit": 1, "myautounit": 1, "dataclass": [1, 3, 29, 31, 32, 33, 34, 35, 84, 85, 86], "ddpstrategi": [1, 86, 87], "want": [1, 14, 20, 25, 27], "custom": [1, 3, 20, 25, 28, 31, 102], "ddp_strategi": 1, "broadcast_buff": [1, 84], "check_reduct": [1, 84], "true": [1, 3, 20, 55, 56, 61, 62, 64, 70, 75, 78, 79, 80, 84, 85, 87, 88, 89, 102, 107, 109, 116], "one": [1, 3, 7, 8, 19, 25, 31, 35, 45, 53, 56, 57, 89, 100], "more": [1, 2, 3, 20, 27, 30, 32, 33, 41, 44, 46, 50, 53, 57, 58, 74, 77, 81, 102], "fullyshardeddataparallel": [1, 85, 88], "forward_prefetch": [1, 85], "limit_all_gath": [1, 85, 88], "show": 2, "basic": [2, 4, 25, 27], "It": [2, 13, 17, 19, 26, 27, 32, 52, 70, 73], "found": [2, 38], "here": [2, 25, 27, 46, 50, 57], "http": [2, 3, 13, 18, 20, 26, 30, 33, 40, 41, 46, 48, 50, 57, 58, 59, 89, 102], "github": [2, 13, 26, 102], "com": [2, 26, 102], "pytorch": [2, 3, 5, 6, 15, 18, 20, 22, 24, 26, 27, 30, 33, 40, 41, 46, 48, 50, 57, 58, 59, 74, 77, 82, 89, 102, 121], "blob": [2, 102], "master": [2, 26], "train_unit_exampl": 2, "py": [2, 102], "less": [2, 70, 76], "code": [2, 3, 4, 9, 15, 25], "featur": 2, "enabl": [2, 3, 20, 52, 58, 89, 107, 109], "out": [2, 4, 77, 102], "box": [2, 4], "auto_unit_exampl": 2, "datapip": 2, "dataloader2": [2, 5, 6, 22, 24], "torchdata_train_exampl": 2, "convnet": 2, "dataset": [2, 3, 21, 25, 28, 29, 31, 34, 35], "main": [2, 20, 26, 27, 102], "class": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 42, 56, 59, 61, 62, 63, 64, 65, 66, 67, 68, 70, 73, 84, 85, 90, 100, 101, 102, 107, 108, 109, 110], "auto_unit": 3, "arg": [3, 11, 14, 27, 36, 54, 65, 67, 94, 95, 96, 97, 98, 99, 101, 110], "kwarg": [3, 14, 36, 54, 60, 65, 67, 74, 94, 95, 96, 97, 98, 99, 101, 107, 110], "sourc": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122], "stochast": 3, "gradient": [3, 9, 27], "descent": 3, "would": 3, "data": [3, 4, 5, 6, 11, 21, 22, 24, 25, 26, 27, 36, 40, 63, 66, 89, 118], "parallel": [3, 89], "replic": [3, 20], "them": [3, 19, 27, 30, 66], "subclass": [3, 4, 6, 25, 27, 28, 32], "implement": [3, 5, 6, 7, 22, 24, 25, 27, 28, 59, 107, 109], "train_step": [3, 6, 24, 25, 27], "eval_step": [3, 5, 6, 25], "predict_step": [3, 22, 25, 27], "method": [3, 20, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 42, 46, 50, 54, 56, 57, 59, 61, 62, 63, 64, 65, 66, 67, 68, 70, 73, 84, 85, 90, 100, 101, 102, 107, 108, 109, 110], "For": [3, 19, 20, 32, 33, 41, 44, 46, 50, 57, 58, 77, 81], "run": [3, 5, 6, 9, 11, 22, 23, 24, 25, 26, 48, 74, 77, 81, 92, 104, 105, 106, 120, 121, 122], "forward": [3, 59, 73, 74], "backward": [3, 25, 27, 59, 73, 89], "step": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 19, 20, 21, 22, 23, 24, 25, 27, 61, 62, 64, 66, 70, 82, 91, 92, 93, 102, 108, 118, 119], "To": [3, 4, 25, 26, 74], "benefit": 3, "must": [3, 7, 8, 9, 19, 20, 27, 56, 57, 67, 74, 89, 102], "compute_loss": [3, 27], "configure_optimizers_and_lr_schedul": [3, 27], "addition": [3, 58], "option": [3, 4, 5, 6, 10, 11, 14, 17, 19, 20, 22, 23, 24, 25, 27, 32, 42, 43, 46, 50, 52, 53, 55, 56, 57, 58, 61, 64, 70, 71, 74, 77, 81, 83, 84, 85, 87, 88, 89, 91, 92, 93, 94, 95, 96, 97, 99, 102, 106, 109, 113, 114, 116, 118], "hook": [3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 25, 27, 84], "on_train_step_end": [3, 4, 6, 8, 9, 10, 11, 13, 15, 17, 19, 24, 27], "on_eval_step_end": [3, 4, 5, 9, 10, 11, 13, 15, 17], "on_predict_step_end": [3, 4, 7, 9, 10, 11, 13, 15, 17, 22], "Then": [3, 25], "evalu": [3, 4, 6, 9, 11, 14, 15, 17, 20, 23, 25, 26, 27], "predict": [3, 4, 7, 9, 10, 11, 13, 14, 15, 16, 17, 23, 25, 26, 27], "entri": [3, 4, 20, 23, 27, 77], "point": [3, 4, 9, 23, 25, 27, 44, 66], "normal": 3, "advanc": 3, "directli": 3, "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 27, 29, 30, 31, 33, 34, 35, 36, 38, 40, 41, 43, 46, 50, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 64, 66, 67, 69, 70, 73, 74, 75, 76, 77, 81, 82, 83, 86, 87, 88, 89, 102, 103, 107, 109, 111, 113, 114, 115, 116, 118], "step_lr_interv": 3, "whether": [3, 8, 16, 19, 20, 23, 40, 56, 61, 73, 102, 107, 109, 116], "lr_schedul": [3, 5, 6, 22, 24, 25, 27], "everi": [3, 9, 16, 19, 20, 21, 27], "default": [3, 7, 9, 14, 16, 17, 20, 25, 28, 31, 32, 34, 40, 43, 46, 48, 49, 50, 53, 55, 57, 58, 61, 66, 68, 70, 77, 81, 86, 107, 109, 113, 114, 116, 118], "precis": [3, 26, 27, 41, 57, 66], "mix": [3, 27], "dtype": [3, 83], "accept": [3, 11, 100], "fp32": 3, "fp16": 3, "bf16": 3, "gradient_accumulation_step": [3, 27], "mani": 3, "batch": [3, 4, 11, 25, 27, 29, 30, 31, 33, 34, 35, 70, 72, 84], "accumul": [3, 27], "over": [3, 25, 27, 29, 31, 32, 33, 34, 35], "detect_anomali": 3, "anomali": [3, 27], "detect": [3, 27], "autograd": 3, "engin": 3, "org": [3, 18, 20, 30, 33, 40, 41, 46, 48, 50, 57, 58, 59, 89], "doc": [3, 18, 30, 40, 41, 46, 48, 50, 57, 58, 89], "stabl": [3, 18, 30, 40, 41, 46, 48, 50, 57, 58, 89], "html": [3, 13, 18, 20, 30, 33, 40, 41, 46, 48, 50, 57, 58, 89], "clip_grad_norm": 3, "max": [3, 5, 6, 22, 24, 56, 118], "norm": [3, 72, 84], "clip": [3, 27], "gener": [3, 4, 9, 14, 20, 32, 33, 40, 41, 58, 66, 69, 74, 75, 89, 112, 115, 116], "util": [3, 5, 6, 10, 14, 18, 20, 22, 24], "clip_grad_norm_": 3, "clip_grad_valu": 3, "clip_grad_value_": 3, "swa_param": 3, "weight": [3, 34, 102], "averag": [3, 10, 102], "torch_compile_param": [3, 89], "compil": [3, 27, 89], "activation_checkpoint_param": [3, 89], "activ": [3, 14, 23, 74, 89], "lr": [3, 27], "creat": [3, 9, 25, 27, 40, 53, 67], "enable_compiled_autograd": [3, 89], "compiled_autograd": [3, 89], "an": [3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 15, 17, 19, 20, 22, 23, 24, 25, 27, 28, 30, 32, 50, 55, 56, 66, 76, 77, 80, 83, 86, 87, 88, 89, 103, 110, 118], "experiment": [3, 89], "certain": [3, 40, 82], "through": [3, 32], "well": [3, 52, 70], "swaparam": 3, "swa": [3, 26], "shard": 3, "same": [3, 7, 9, 20, 25, 31, 32, 33, 43, 66, 72, 107], "avail": [3, 20, 37, 47, 51, 55, 57, 77, 81, 82, 107, 109, 116], "0": [3, 8, 17, 20, 27, 29, 31, 34, 35, 47, 48, 50, 52, 55, 56, 58, 61, 62, 64, 66, 67, 84, 90, 94, 95, 96, 97, 98, 99, 102, 108, 111, 113, 114, 120, 121], "higher": 3, "abstract": [3, 25, 26, 27, 28, 62, 65], "tdata": [3, 23], "tupl": [3, 14, 25, 27, 74], "tensor": [3, 8, 25, 27, 29, 31, 34, 35, 40, 43, 74, 82, 84], "ani": [3, 5, 6, 14, 20, 22, 24, 25, 27, 36, 54, 55, 58, 60, 67, 74, 94, 95, 96, 97, 98, 99, 107], "call": [3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 27, 36, 40, 46, 50, 52, 67, 82, 98, 107, 109], "object": [3, 5, 6, 9, 19, 22, 23, 24, 25, 29, 31, 32, 33, 34, 35, 53, 59, 74, 76, 84, 91, 92, 93, 100, 114, 115, 118], "return": [3, 25, 27, 29, 31, 34, 35, 36, 38, 39, 43, 47, 51, 52, 53, 54, 55, 57, 60, 78, 79, 80, 92, 93, 103, 111, 113, 114], "contain": [3, 20, 23, 25, 26, 27, 28, 29, 30, 32, 53, 73, 74, 83], "output": [3, 7, 17, 23, 25, 27, 66, 73, 74, 77, 81, 118], "part": [3, 27], "lrschedul": [3, 100], "construct": [3, 30, 40, 67, 118], "upon": [3, 20], "A": [3, 4, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 21, 23, 29, 31, 32, 33, 34, 35, 38, 42, 50, 54, 59, 68, 69, 74, 82, 93, 107, 109, 111, 113, 114], "requir": [3, 25, 58, 59], "iter": [3, 5, 6, 10, 20, 21, 22, 23, 24, 25, 29, 30, 31, 32, 33, 34, 35, 85, 91, 92, 93, 118], "wish": [3, 25], "decor": [3, 25, 52], "inference_mod": [3, 25], "improv": [3, 8, 9, 25, 56], "metadata": [3, 25], "get_next_eval_batch": [3, 5, 25], "data_it": [3, 25], "union": [3, 4, 7, 10, 11, 12, 16, 17, 18, 19, 20, 21, 25, 29, 31, 32, 33, 34, 35, 53, 55, 58, 84, 85, 86, 89, 100, 118], "next": [3, 4, 11, 25, 31], "input": [3, 25, 27, 31, 53, 55, 58, 73, 111, 113, 114, 115], "otherwis": [3, 9, 25, 40, 47, 51, 102], "overrid": [3, 25], "logic": [3, 4, 25, 32, 33], "get": [3, 4, 17, 25, 33, 37, 38, 39, 46, 47, 48, 49, 50, 51, 120, 121], "get_next_predict_batch": [3, 22, 25], "get_next_train_batch": [3, 6, 24, 25], "int": [3, 5, 6, 8, 9, 10, 14, 17, 19, 20, 22, 23, 24, 27, 28, 30, 46, 47, 48, 50, 51, 54, 55, 56, 58, 61, 62, 64, 66, 69, 71, 76, 77, 84, 85, 90, 91, 92, 93, 103, 107, 117, 118, 119], "none": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 40, 41, 42, 43, 44, 45, 46, 50, 52, 53, 55, 56, 57, 58, 59, 61, 62, 63, 64, 66, 67, 68, 69, 70, 72, 73, 74, 76, 77, 81, 82, 84, 85, 87, 88, 89, 90, 92, 93, 94, 95, 96, 97, 98, 99, 100, 102, 107, 108, 109, 113, 114, 116, 117, 118, 119], "end": [3, 4, 7, 8, 9, 10, 11, 13, 15, 17, 18, 19, 20, 21, 23, 25, 27], "befor": [3, 4, 7, 9, 12, 13, 14, 15, 16, 17, 19, 21, 25, 59, 61, 62, 64, 70, 107, 109], "updat": [3, 9, 17, 20, 26, 27, 102, 117, 119], "log": [3, 10, 12, 14, 16, 18, 20, 21, 26, 27, 61, 62, 63, 64, 66, 67, 94, 95, 96, 97, 99, 107, 109, 116], "metric": [3, 8, 20, 26, 27, 56, 65, 66], "do": [3, 8, 26, 27, 66], "anyth": 3, "els": [3, 52, 61, 62, 64], "been": [3, 19, 29, 35, 57], "complet": [3, 20, 23, 118, 119], "on_train_epoch_end": [3, 4, 6, 8, 11, 17, 18, 19, 21, 24, 25, 27], "note": [3, 13, 53, 58], "rememb": 3, "super": [3, 25, 27], "result": [3, 9, 27, 43, 55, 68, 108, 112], "trainstepresult": [3, 27], "total": [3, 20, 28, 92, 93], "autopredictunit": 3, "str": [3, 4, 7, 8, 12, 14, 19, 20, 27, 29, 31, 32, 33, 34, 35, 38, 39, 41, 46, 49, 50, 53, 54, 55, 57, 58, 60, 61, 62, 64, 67, 70, 74, 75, 77, 81, 83, 85, 86, 89, 100, 111, 112, 113, 114, 115, 116, 118], "torchcompileparam": [3, 89], "bool": [3, 20, 23, 32, 55, 56, 61, 62, 64, 75, 78, 79, 80, 84, 85, 89, 102, 104, 105, 109, 116, 122], "tpredictdata": [3, 4, 7, 9, 10, 11, 13, 14, 15, 16, 17, 20, 22, 25], "extens": [4, 27], "supplement": [4, 20], "loop": [4, 5, 6, 9, 11, 19, 22, 23, 24, 25, 26, 27, 90, 93, 118], "addit": [4, 20, 25, 27, 40, 107], "good": [4, 66], "candid": 4, "ones": [4, 20], "re": [4, 59, 82], "across": [4, 7, 9, 20, 21, 44, 55, 58, 113, 114], "intend": [4, 27, 28, 57], "go": 4, "write": [4, 7, 21, 40, 61, 62, 64, 67, 81], "add": [4, 44], "below": [4, 5, 6, 22, 24, 25], "exampl": [4, 5, 6, 11, 19, 20, 22, 24, 25, 29, 30, 31, 32, 33, 34, 35, 52, 53, 54, 55, 59, 63, 66, 67, 70, 87, 88, 103, 120, 121], "print": [4, 11, 14, 16, 27, 29, 31, 34, 35, 55, 66, 75, 98], "messag": [4, 17, 80, 94, 95, 96, 97, 99, 118], "variou": [4, 26, 27], "execut": [4, 5, 6, 9, 22, 23, 24, 52, 56, 57], "import": [4, 5, 6, 9, 11, 22, 24, 25, 27, 52, 59, 63, 66, 67, 103], "tevalunit": [4, 27], "tpredictunit": [4, 27], "ttrainunit": [4, 27], "printingcallback": [4, 27], "def": [4, 11, 25, 27, 52], "on_train_start": [4, 6, 9, 11, 14, 15, 19, 20, 21, 24, 25, 27], "self": [4, 25, 27], "start": [4, 7, 9, 11, 12, 14, 15, 16, 17, 19, 20, 21, 23, 25, 27, 70, 102], "on_train_end": [4, 6, 9, 11, 15, 24, 25, 27], "on_eval_start": [4, 5, 9, 11, 14, 15, 25, 27], "on_eval_end": [4, 5, 9, 11, 15, 25, 27], "on_predict_start": [4, 7, 9, 11, 14, 15, 22, 25, 27], "on_predict_end": [4, 7, 9, 11, 15, 22, 25, 27], "instanti": [4, 13, 27, 70], "printing_callback": 4, "train_unit": [4, 24, 25], "properti": [4, 20, 23], "distinct": 4, "per": [4, 5, 6, 22, 23, 24, 66, 107, 118], "instanc": [4, 5, 6, 10, 13, 18, 20, 22, 23, 24, 32, 70, 86, 87, 88, 103], "debug": [4, 23, 27, 95], "profil": [4, 15, 68, 70], "purpos": 4, "tevaldata": [4, 5, 6, 7, 9, 10, 11, 13, 14, 15, 16, 17, 20, 25], "on_eval_epoch_end": [4, 5, 11, 17, 25], "on_eval_epoch_start": [4, 5, 11, 16, 17, 25], "new": [4, 12, 16, 17, 25, 46, 53, 67], "on_eval_get_next_batch_end": [4, 11], "on_eval_step_start": [4, 5, 11, 16], "on_except": [4, 7, 11, 20], "ttraindata": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 24, 25], "exc": [4, 7, 20], "baseexcept": [4, 7, 11, 20, 78, 79, 80], "except": [4, 5, 6, 7, 11, 20, 22, 24, 32, 78, 79, 80], "occur": [4, 7, 11, 20, 21, 77, 102], "on_predict_epoch_end": [4, 11, 17, 22, 25], "on_predict_epoch_start": [4, 11, 16, 17, 22, 25], "on_predict_get_next_batch_end": [4, 11], "on_predict_step_start": [4, 11, 16, 22], "on_train_epoch_start": [4, 6, 11, 12, 16, 17, 24, 25], "on_train_get_next_batch_end": [4, 11], "on_train_step_start": [4, 6, 11, 12, 16, 24], "sever": [4, 25, 27, 43], "pre": 4, "written": [4, 7, 67], "readi": 4, "eval_unit": [5, 25], "eval_dataload": [5, 6, 92], "max_steps_per_epoch": [5, 22, 23, 24, 91, 93, 118], "list": [5, 6, 7, 12, 14, 16, 20, 21, 22, 24, 43, 54, 68, 69, 111, 113], "timer": [5, 6, 22, 23, 24, 26], "timerprotocol": [5, 6, 22, 23, 24, 107, 109, 114, 115], "take": [5, 6, 9, 20, 22, 24], "modifi": [5, 6, 22, 23, 24, 25], "includ": [5, 6, 16, 22, 24, 26, 27, 33, 57, 84, 90], "etc": [5, 6, 14, 20, 22, 24, 27, 32, 33, 54], "number": [5, 6, 9, 17, 20, 22, 23, 24, 28, 30, 43, 46, 50, 54, 56, 58, 61, 62, 64, 66, 73, 77, 91, 92, 93, 102, 103, 107, 118, 119], "mean": [5, 6, 22, 24, 59, 73, 111, 113, 114], "until": [5, 6, 22, 24, 29], "exhaust": [5, 6, 22, 24, 29, 31, 34, 35], "kei": [5, 6, 20, 22, 23, 24, 29, 31, 32, 33, 34, 35, 38, 39, 68], "event": [5, 6, 22, 23, 24, 67, 70, 116], "synchron": [5, 6, 9, 22, 24, 44, 46, 52, 55, 67, 107, 109, 113, 114, 116], "degrad": [5, 6, 22, 24], "myevalunit": [5, 25], "20": [5, 19, 22, 53], "pseudocod": [5, 6, 22, 24], "what": [5, 6, 20, 22, 24, 102], "doe": [5, 6, 8, 9, 22, 24, 82], "first": [5, 6, 19, 22, 24, 26, 82], "while": [5, 6, 22, 24, 29, 35], "try": [5, 6, 22, 24], "increment": [5, 6, 22, 24], "counter": [5, 6, 22, 24, 59], "stopiter": [5, 6, 22, 24], "break": [5, 6, 22, 24], "max_epoch": [6, 23, 24, 27], "max_step": [6, 23, 24, 91, 92, 93, 118], "max_train_steps_per_epoch": [6, 92], "max_eval_steps_per_epoch": [6, 92], "evaluate_every_n_step": [6, 23], "evaluate_every_n_epoch": [6, 23], "interleav": [6, 25, 27, 30], "both": [6, 19], "limit": [6, 19, 24], "infinit": [6, 24, 56], "unless": [6, 24], "stop": [6, 8, 19, 23, 24, 26, 29, 34, 35, 56], "often": [6, 19], "term": [6, 21, 23], "fit_unit": 6, "myfitunit": 6, "4": [6, 24, 29, 31, 34, 35, 55, 66], "header_row": 7, "dir_path": 7, "delimit": 7, "t": [7, 27, 36, 40, 58, 59, 92, 93], "filenam": [7, 46, 81], "csv": [7, 61], "file": [7, 13, 17, 46, 57, 61, 62, 64, 67, 70, 118], "simplifi": [7, 26, 27], "extend": [7, 25], "get_step_output_row": 7, "desir": [7, 52], "row": 7, "all": [7, 9, 13, 14, 20, 27, 29, 31, 33, 34, 43, 44, 53, 55, 61, 62, 64, 67, 115], "match": 7, "column": 7, "defin": [7, 19, 23, 25, 27, 32, 33, 35, 67, 87, 88, 101, 107, 110], "directori": [7, 13, 20, 70, 77, 81], "where": [7, 13, 17, 20, 25, 40, 43, 54, 70, 118], "separ": 7, "tab": 7, "monitored_attr": 8, "early_stop_check": 8, "earlystopcheck": 8, "interv": [8, 19, 27, 68, 69, 108], "liter": [8, 16, 19, 55, 56, 57, 102], "interval_freq": [8, 19], "check": [8, 19, 56, 102], "earli": [8, 13, 26, 56], "rank": [8, 17, 19, 20, 26, 46, 47, 48, 50, 52, 54, 55, 61, 62, 64, 66, 67, 94, 95, 96, 97, 98, 99, 103, 108, 113, 114], "step_interv": 9, "period": [9, 20, 68, 69], "garbag": 9, "collect": [9, 13, 20, 42, 67, 73], "In": [9, 25, 43, 55, 56], "fulli": 9, "program": [9, 37, 40, 57, 122], "multipl": [9, 40, 41, 57, 100], "These": [9, 25, 27, 123], "need": [9, 20, 25, 27, 40, 52, 102, 123], "commun": [9, 19, 20, 50, 54, 84], "other": [9, 20, 55, 108], "especi": [9, 21], "overal": 9, "therefor": 9, "gate": 9, "slowest": 9, "roughli": 9, "amount": [9, 19], "its": [9, 40, 73, 74], "straggler": 9, "python": [9, 58, 104, 105, 120], "trigger": 9, "differ": [9, 20, 25, 26, 27, 43, 66], "possibl": [9, 13, 19], "lead": 9, "frequenc": [9, 10, 20, 23, 27], "tune": 9, "base": [9, 20, 28, 37, 57, 59, 80, 102], "hand": 9, "free": [9, 40, 50, 54, 70], "some": [9, 25, 82], "reap": 9, "minim": 9, "overhead": 9, "compar": 9, "full": 9, "cleanup": 9, "logger": [10, 12, 16, 18, 21, 26, 27, 94, 95, 96, 97, 99], "metriclogg": [10, 12, 16, 21], "summarywrit": [10, 18, 67], "moving_avg_window": 10, "log_every_n_step": [10, 27], "scalar": 10, "tensorboard": [10, 18, 27, 67], "tensorboardlogg": [10, 18, 27], "control": [10, 13, 20, 25, 27, 58], "window": [10, 122], "callabl": [11, 14, 52, 54, 84, 85, 106], "retriev": 11, "mydataload": 11, "print_on_step_start": 11, "f": [11, 55], "eval_progress": 11, "num_steps_complet": [11, 27, 90, 91, 117, 118, 119], "lambda_cb": 11, "logging_interv": [12, 16], "associ": 12, "memory_snapshot_profil": 13, "memorysnapshotprofilerbas": 13, "memori": [13, 16, 26, 30, 40, 63, 70, 77, 81, 82], "snapshot": [13, 20, 70, 77, 81], "pickl": 13, "zdevito": 13, "io": 13, "2022": 13, "08": 13, "16": 13, "recommend": [13, 27, 30], "ideal": [13, 59, 70], "sure": [13, 26], "alloc": [13, 40, 70, 82], "captur": [13, 68], "max_depth": [14, 76], "process_fn": 14, "module_summari": 14, "_log_module_summary_t": 14, "module_input": [14, 59], "mutablemap": [14, 74], "summari": [14, 26, 73, 76, 115], "maximum": [14, 19, 23, 76, 77], "depth": [14, 76], "tabl": 14, "map": [14, 29, 31, 33, 34, 35, 38, 39, 111, 113, 114], "flop": [14, 26, 73, 74], "size": [14, 16, 28, 43, 51, 68, 69, 73, 74], "rais": [14, 19, 32, 37, 38, 56, 58, 70, 76, 83, 86, 107, 109, 111, 113, 114, 115, 116], "runtimeerror": [14, 37], "torchev": 14, "instal": 14, "context": [15, 37, 59, 69], "manag": [15, 20, 59, 69], "system": [16, 46, 122], "stat": [16, 27, 38, 39], "cpu": [16, 23, 37, 39, 53, 78], "usag": 16, "resid": [16, 68, 69], "gpu": [16, 37, 38, 107, 109], "refresh_r": [17, 117, 119], "textio": [17, 118], "stringio": [17, 118], "progress": [17, 20, 21, 26, 27, 100, 117, 118, 119], "bar": [17, 117, 118, 119], "visual": [17, 21, 70], "environ": [17, 26, 37, 46, 48, 50, 57, 67, 121], "determin": [17, 19, 41, 56, 58, 104, 105], "sy": [17, 118], "stderr": [17, 118], "histogram": [18, 111, 113], "writer": 18, "durat": [19, 111, 112, 113, 114], "timedelta": [19, 57, 68, 69, 108], "timestamp": 19, "datetim": [19, 57, 68, 69], "spent": 19, "reach": [19, 107], "job": 19, "absolut": [19, 56], "At": 19, "least": [19, 55], "condit": [19, 47, 51], "met": [19, 47, 51], "spend": 19, "form": 19, "dd": 19, "hh": 19, "mm": 19, "dai": [19, 71], "hour": 19, "minut": [19, 57], "00": 19, "indic": [19, 20, 29, 31, 32, 33, 34, 35, 93], "even": 19, "ha": [19, 26, 27, 29, 32, 33, 35, 56, 57, 115], "yet": 19, "timezon": 19, "awar": 19, "exceed": 19, "two": [19, 26, 27, 35, 72], "valueerror": [19, 56, 58, 70, 76, 83, 86, 107, 109, 111, 113, 114, 115, 116], "i": [19, 43, 54], "e": [19, 25, 27, 75], "between": [19, 56, 72], "process_group": [20, 84, 85], "processgroup": [20, 42, 43, 55, 84, 85, 108, 113, 114], "async_checkpoint": 20, "storage_opt": 20, "knob_opt": 20, "knobopt": 20, "appstatemixin": 20, "random": [20, 28, 58], "epoch_": 20, "_step_": 20, "parent": [20, 23], "intra": 20, "most": [20, 116], "recent": 20, "excess": 20, "present": 20, "oldest": [20, 107], "delet": 20, "clean": 20, "best": 20, "config": [20, 103], "n": [20, 55], "read": [20, 23, 32, 33], "off": 20, "prior": 20, "entir": 20, "world": [20, 42, 43, 51], "asynchron": [20, 61, 108], "glob": 20, "pattern": 20, "inform": [20, 23, 41, 46, 50, 53, 57, 73, 75, 77, 81], "see": [20, 27, 41, 46, 50, 57, 58, 77, 81, 102], "api_refer": 20, "safer": 20, "realli": 20, "thing": 20, "grad_scal": 20, "mark": 20, "thei": [20, 66], "unsur": 20, "leav": 20, "field": 20, "unset": 20, "keyword": [20, 36, 67], "storag": 20, "plugin": 20, "document": [20, 32, 33], "knob": 20, "constructor": 20, "oper": [20, 30, 41, 57, 58, 67, 122], "broadcast": [20, 43, 55], "state_dict": [20, 82, 90, 100], "castabl": 20, "maintain": [20, 26, 27], "accuraci": [20, 27, 63, 66, 67], "respons": 20, "reset": [20, 27, 59, 108, 110], "collis": 20, "app": [20, 42], "static": 20, "restor": [20, 82], "skip": [20, 29, 32, 35, 102, 106], "filter": 20, "vs": [21, 75], "predict_unit": [22, 25], "predict_dataload": 22, "mypredictunit": [22, 25], "entry_point": 23, "entrypoint": [23, 103], "train_stat": 23, "tstepoutput": 23, "eval_st": 23, "predict_st": 23, "phase": [23, 25], "active_phas": 23, "activephas": 23, "current": [23, 37, 55, 57, 74, 91, 93, 120, 121, 122], "One": 23, "meta": 23, "should_stop": 23, "termin": 23, "signal": [23, 56], "record": [23, 40, 70, 77, 111, 112, 113, 114, 115], "latenc": 23, "iteration_tim": 23, "alwai": 23, "without": [23, 56], "synchronis": 23, "step_output": 23, "last": 23, "mytrainunit": [24, 25], "concept": [25, 27], "repres": [25, 27, 84, 85], "primari": [25, 27], "place": [25, 27, 82], "organ": 25, "mutual": [25, 27], "exclus": [25, 27], "g": [25, 27, 75], "case": [25, 27, 43, 55], "allow": [25, 42, 102], "behavior": [25, 107], "fetch": [25, 46, 50], "simpl": [25, 63, 67], "typecheck": 25, "__init__": [25, 27, 28, 29, 30, 31, 32, 33, 34, 35, 42, 56, 59, 61, 62, 63, 64, 65, 66, 67, 68, 70, 73, 84, 85, 90, 100, 101, 102, 107, 108, 109, 110], "_lrschedul": 25, "target": [25, 27], "binary_cross_entropy_with_logit": [25, 27], "zero_grad": [25, 27], "plan": 25, "refer": [25, 32, 33, 44], "my_unit": [25, 27], "librari": [26, 27, 58], "tool": [26, 27], "compon": [26, 27], "level": [26, 27], "repo": [26, 27], "lightweight": [26, 27], "grab": [26, 27], "bag": [26, 27], "independ": [26, 27, 123], "relat": [26, 27, 78, 79, 123], "wrapper": [26, 27, 42, 100], "publish": [26, 27], "pip": 26, "issu": [26, 42], "version": [26, 102], "just": 26, "git": 26, "upgrad": 26, "checker": 26, "filesystem": [26, 60], "spec": 26, "memorysnapshotprofil": 26, "oom": [26, 70], "prepar": 26, "zero": [26, 70, 82], "test": [26, 106], "tqdm": 26, "misc": 26, "welcom": 27, "descript": [27, 118], "immedi": 27, "infer": [27, 118], "combin": 27, "myexampleunit": 27, "_modul": 27, "_devic": 27, "_optim": 27, "_log_every_n_step": 27, "_accuraci": 27, "binaryaccuraci": 27, "_tb_logger": 27, "trainer": 27, "our": 27, "task": 27, "copy_data_to_devic": 27, "squeez": 27, "step_count": 27, "train_progress": 27, "acc": 27, "log_dict": [27, 66], "train_accuraci": 27, "train_accuracy_epoch": 27, "predictbatch": 27, "256": 27, "10": [27, 29, 31, 34, 35, 63, 67, 70], "1000": 27, "5": [27, 29, 31, 34, 35, 55, 70], "howev": 27, "don": [27, 58], "necessarili": 27, "themselv": 27, "appli": [27, 102, 107], "tb_logger": 27, "multiclassaccuraci": 27, "gamma": 27, "tlrschedul": 27, "adadelta": 27, "steplr": 27, "step_siz": 27, "nll_loss": 27, "_": 27, "mechan": [27, 29, 34, 35], "inject": 27, "within": [27, 37, 58], "wai": 27, "page": 27, "detail": [27, 32, 33, 58], "suit": 27, "rang": [27, 29, 31, 34, 35, 37, 55, 58, 107, 111, 113, 114], "concret": 28, "_generate_random_item": 28, "produc": 28, "singl": [28, 31, 42, 54, 74, 103], "item": [28, 29, 31, 34, 35], "titem": 28, "individual_dataload": [29, 31, 32, 33, 34, 35], "iteration_strategi": [29, 31, 32, 33, 34, 35], "alldatasetbatch": 29, "all_datasets_exhaust": [29, 34, 35], "finish": 29, "till": [29, 31, 35], "largest": [29, 35], "those": [29, 35], "smallest_dataset_exhaust": [29, 35], "onc": [29, 35, 40, 56], "smallest": [29, 35], "restart_until_all_datasets_exhaust": 29, "restart": 29, "format": [29, 31, 34, 35, 112], "dataloader_1_nam": 29, "batch_obtained_from_dataloader_1": 29, "dataloader_2_nam": 29, "batch_obtained_from_dataloader_2": 29, "loader": [29, 31, 34, 35], "batch_siz": [29, 31, 34, 35], "b": [29, 31, 34, 35], "15": [29, 31, 34, 35], "all_dataset_batch_strategi": 29, "stopping_mechan": [29, 34, 35], "stoppingmechan": [29, 34, 35], "combined_iter": [29, 31, 34, 35], "6": [29, 31, 34, 35], "7": [29, 31, 34, 35], "8": [29, 31, 34, 35, 103, 120], "9": [29, 31, 34, 35], "11": [29, 31, 34, 35], "12": [29, 31, 34, 35, 121], "13": [29, 31, 34, 35, 59, 74], "14": [29, 31, 34, 35], "data_iter": 30, "num_prefetch_batch": 30, "prefetch": 30, "host": [30, 77, 81], "copi": [30, 36, 59, 102], "effect": 30, "leverag": 30, "pin": 30, "data_prefetch": 30, "alreadi": [30, 45, 57, 102], "inord": 31, "order": [31, 33, 35, 66, 108, 116], "overridden": 31, "repetit": 31, "dataloader_nam": [31, 34, 35], "batch_from_dataload": [31, 34, 35], "randomizedbatchsampl": [31, 34], "in_order_strategi": 31, "randomizedbatchsampleriter": 31, "dataiterationstrategi": [32, 33], "iterator_cl": 32, "multiiter": 32, "ignore_empty_data": 32, "cycl": [32, 33, 35], "individu": [32, 33], "dictionari": [32, 107, 109, 111, 113, 114], "torchdata": [32, 33], "multi": [32, 33, 54, 103], "achiev": [32, 33], "mux": [32, 33], "mux_longest": [32, 33], "zip": [32, 33], "pleas": [32, 33, 44], "given": [33, 56, 60, 108, 115, 116], "accompani": 33, "particular": 33, "beta": 33, "randomli": 34, "sampl": [34, 107], "chang": [34, 56], "anoth": [34, 40], "randomized_batch_sampl": 34, "roundrobin": 35, "robinrobin": 35, "round_robin_strategi": 35, "recurs": 36, "posit": [36, 67], "correct": 36, "mp": 37, "reli": [37, 82], "local_rank": [37, 48], "variabl": [37, 48, 67], "made": 37, "launcher": [37, 103], "outsid": [37, 58], "gpustat": 38, "nvidia": 38, "smi": 38, "utilization_gpu_perc": 38, "utilization_memory_perc": 38, "fan_speed_perc": 38, "memory_used_mb": 38, "memory_free_mb": 38, "temperature_gpu_celsiu": 38, "temperature_memory_celsiu": 38, "filenotfounderror": 38, "command": 38, "cpustat": 39, "psutil": 39, "cpu_vm_perc": 39, "cpu_perc": 39, "cpu_swap_perc": 39, "worker_cpu_time_us": 39, "worker_cpu_time_system": 39, "worker_rss": 39, "stream": [40, 116], "element": 40, "being": [40, 116], "reus": 40, "mention": 40, "record_stream": 40, "cach": 40, "freed": 40, "newli": 40, "trace": [40, 77], "still": 40, "wa": 40, "tell": 40, "might": [40, 100], "underli": 40, "longer": 40, "creator": 40, "notabl": 40, "trick": 40, "high": [41, 57], "float32": 41, "matrix": [41, 57], "convolut": 41, "set_float32_matmul_precis": 41, "backend": [41, 49, 54, 57], "cudnn": [41, 58], "allow_tf32": 41, "datatyp": 41, "pg": [42, 55, 113, 114], "consist": 42, "fashion": 42, "regardless": 42, "follow": [42, 57, 66, 73], "scenario": 42, "gather": 43, "onto": 43, "dimens": [43, 53], "pad": 43, "trim": 43, "secur": 43, "equal": [43, 57, 70], "workload": 43, "sync": [43, 84, 111, 113, 114], "gathered_result": 43, "correspond": 43, "granular": 44, "pgwrapper": 44, "destroi": 45, "world_siz": [46, 50, 51, 54], "init": [46, 50], "tcp": [46, 50, 57], "protocol": [46, 50, 110], "share": 46, "worker": [46, 50], "get_world_s": [46, 50], "get_global_rank": [46, 50], "temporari": 46, "env": [47, 51], "var": [47, 51], "neither": [47, 51, 70], "popul": 48, "elast": 48, "hostnam": 50, "port": [50, 54], "address": 50, "belong": [50, 66], "localhost": [50, 54], "select": 50, "fn": 52, "treturn": [52, 54, 106], "judici": 52, "never": 52, "veri": 52, "carefulli": 52, "mutat": 52, "local": 52, "foo": 52, "x": 52, "wrapped_fn": 52, "helper": [53, 112], "convert": [53, 71, 83, 86], "syncbatchnorm": 53, "layer": 53, "batchnorm": 53, "revert": 53, "convert_sync_batchnorm": 53, "origin": 53, "network": 53, "sequenti": 53, "batchnorm1d": 53, "sync_bn_modul": 53, "reverted_modul": 53, "method_arg": 54, "method_kwarg": 54, "spawn": 54, "node": [54, 103], "nccl": 54, "gloo": 54, "l": 54, "methods_kwarg": 54, "val": 55, "coherence_mod": 55, "rank_zero": 55, "boolean": 55, "member": 55, "manner": 55, "receiv": 55, "truth": 55, "integ": [55, 58, 118], "ratio": 55, "synced_v": 55, "iff": 55, "success": [55, 66], "patienc": 56, "min_delta": 56, "check_finit": 56, "threshold_mod": 56, "ab": 56, "rel": 56, "stopping_threshold": 56, "divergence_threshold": 56, "decreas": 56, "increas": 56, "minimum": 56, "qualifi": 56, "improvement_threshold": 56, "best_val": 56, "threshold": 56, "becom": 56, "nan": 56, "delta": [56, 68, 69], "beyond": 56, "wors": 56, "than": [56, 70, 76, 107], "device_typ": 57, "dist_init_method_typ": 57, "pg_backend": 57, "pg_timeout": 57, "second": [57, 71], "1800": 57, "float32_matmul_precis": 57, "launch": [57, 103], "spmd": 57, "style": [57, 102], "timeout": 57, "against": 57, "30": 57, "determinist": 58, "pseudo": 58, "commonli": 58, "numpi": 58, "error": [58, 77, 80, 96], "warn": [58, 99], "nondeterminist": 58, "benchmark": 58, "disabl": 58, "set_deterministic_debug_mod": 58, "algorithm": 58, "measur": [59, 68, 69, 108, 116], "count": 59, "dev": 59, "discuss": 59, "dispatch": 59, "505": 59, "torchvis": 59, "resnet18": 59, "randn": 59, "224": 59, "ftdm": 59, "flops_forward": 59, "deepcopi": [59, 102], "flop_count": 59, "flops_backward": 59, "abstractfilesystem": 60, "steps_before_flush": [61, 62, 64], "log_all_rank": [61, 62, 64], "async_writ": 61, "header": 61, "buffer": [61, 63], "flush": [61, 62, 64], "store": [62, 64, 68, 100, 107, 109, 110], "23": [63, 67], "56": [63, 67], "close": [63, 67, 117], "json": 64, "stdout": 66, "line": 66, "were": 66, "treat": 66, "opaqu": 66, "identifi": 66, "consecut": 66, "practic": 66, "digit": 66, "decim": 66, "rule": 66, "round": [66, 68], "usual": 66, "982378": 66, "23112": 66, "payload": 66, "99123": 66, "18787": 66, "9824": 66, "2311": 66, "9912": 66, "1879": 66, "On": 67, "extra": 67, "tmp": [67, 70], "tb_log": 67, "microsecond": [68, 69], "100000": [68, 69, 70], "rss": [68, 69], "baselin": [68, 69], "rss_deltas_byt": 68, "100m": 68, "byte": [68, 69, 73], "rss_delta": 69, "output_dir": [70, 77, 81], "memory_snapshot_param": 70, "memorysnapshotparam": 70, "histori": 70, "dump": 70, "offlin": 70, "stai": 70, "constant": 70, "account": 70, "start_step": 70, "neg": 70, "stop_step": 70, "greater": [70, 74], "nor": 70, "enable_oom_observ": 70, "src_modul": 72, "dst_modul": 72, "transfer": 72, "statist": 72, "submodul": [73, 74], "trainabl": 73, "estim": [73, 91, 92, 93], "uniniti": 73, "calcul": [73, 74, 92], "shape": 73, "elaps": [73, 108, 116], "ms": 73, "module_arg": 74, "module_kwarg": 74, "modulesummari": [74, 75, 76], "assign": 74, "tree": [74, 76], "summar": 74, "lazi": 74, "NOT": 74, "todo": 74, "flexibl": [74, 102], "human_readable_num": 75, "summary_t": 75, "tabular": [75, 112], "exact": 75, "1234": 75, "k": 75, "prune": 76, "deeper": 76, "prun": 76, "inplac": 76, "root": 76, "trace_max_entri": 77, "1000000": 77, "attach": 77, "blog": [77, 81], "post": [77, 81], "due": 80, "file_prefix": 81, "prefix": 81, "memory_snapshot": 81, "grad": 82, "necessari": [82, 100], "becaus": [82, 100], "adamw": 82, "lazili": 82, "solut": 82, "ensur": [82, 102, 107, 109], "invalid": [83, 86], "output_devic": 84, "dim": 84, "bucket_cap_mb": 84, "25": 84, "find_unused_paramet": [84, 87], "gradient_as_bucket_view": [84, 87], "static_graph": 84, "comm_stat": 84, "comm_hook": 84, "gradbucket": 84, "futur": 84, "sync_batchnorm": 84, "regist": 84, "sharding_strategi": 85, "shardingstrategi": 85, "cpu_offload": 85, "cpuoffload": 85, "auto_wrap_polici": 85, "backward_prefetch": 85, "backwardprefetch": 85, "backward_pr": 85, "mixed_precis": 85, "mixedprecis": 85, "ignored_modul": 85, "param_init_fn": 85, "sync_module_st": 85, "use_orig_param": 85, "state_dict_config": 85, "statedictconfig": 85, "optim_state_dict_config": 85, "optimstatedictconfig": 85, "noopstrategi": 86, "api": [87, 88, 100], "ddp_modul": 87, "fsdp_modul": 88, "activationcheckpointparam": 89, "noop": 89, "num_epochs_complet": [90, 118], "num_steps_completed_in_epoch": 90, "load_state_dict": 90, "remain": 91, "eval_every_n_step": 92, "eval_every_n_epoch": 92, "couldn": [92, 93], "critic": 94, "info": 97, "stateful_obj": 100, "fsdpoptimizerwrapp": 100, "load_checkpoint": 100, "use_buff": 102, "averaging_method": 102, "ema": 102, "ema_decai": 102, "999": 102, "skip_deepcopi": 102, "use_lit": 102, "streamlin": 102, "give": 102, "compat": 102, "swa_util": 102, "l66": 102, "entail": 102, "exponenti": 102, "decai": 102, "ignor": 102, "somewai": 102, "lit": 102, "adjust": 102, "small": 102, "approach": 102, "nproc": 103, "launchconfig": 103, "pet": 103, "launch_config": 103, "elastic_launch": 103, "interpret": [104, 105], "asan": [104, 106], "tsan": 105, "func": 106, "lower_bound": 107, "upper_bound": 107, "recorded_dur": [107, 109, 110, 111, 113], "size_bound": 107, "lower": 107, "upper": 107, "bound": 107, "smaller": 107, "remov": 107, "action": [107, 111, 113, 114, 115], "cuda_sync": [107, 109, 116], "verbos": [107, 109], "incur": [107, 109], "hit": [107, 109], "accur": [107, 109, 116], "cpu_pg": 108, "propag": 108, "previou": 108, "block": 108, "percentil": [111, 113, 114], "sequenc": [111, 113, 114], "whose": 114, "action_nam": 116, "progress_bar": [117, 119], "tqdm_asyncio": [117, 118, 119], "desc": 118, "far": 118, "he": 118, "reflect": 119, "runtim": [120, 121], "Is": 122}, "objects": {"torchtnt.framework.auto_unit": [[3, 0, 1, "", "AutoPredictUnit"], [3, 0, 1, "", "AutoUnit"]], "torchtnt.framework.auto_unit.AutoPredictUnit": [[3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "predict_step"]], "torchtnt.framework.auto_unit.AutoUnit": [[3, 1, 1, "", "compute_loss"], [3, 1, 1, "", "configure_optimizers_and_lr_scheduler"], [3, 1, 1, "", "eval_step"], [3, 1, 1, "", "get_next_eval_batch"], [3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "get_next_train_batch"], [3, 1, 1, "", "on_eval_step_end"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "on_train_epoch_end"], [3, 1, 1, "", "on_train_step_end"], [3, 1, 1, "", "predict_step"], [3, 1, 1, "", "train_step"]], "torchtnt.framework": [[4, 2, 0, "-", "callback"]], "torchtnt.framework.callback": [[4, 0, 1, "", "Callback"]], "torchtnt.framework.callback.Callback": [[4, 3, 1, "", "name"], [4, 1, 1, "", "on_eval_end"], [4, 1, 1, "", "on_eval_epoch_end"], [4, 1, 1, "", "on_eval_epoch_start"], [4, 1, 1, "", "on_eval_get_next_batch_end"], [4, 1, 1, "", "on_eval_start"], [4, 1, 1, "", "on_eval_step_end"], [4, 1, 1, "", "on_eval_step_start"], [4, 1, 1, "", "on_exception"], [4, 1, 1, "", "on_predict_end"], [4, 1, 1, "", "on_predict_epoch_end"], [4, 1, 1, "", "on_predict_epoch_start"], [4, 1, 1, "", "on_predict_get_next_batch_end"], [4, 1, 1, "", "on_predict_start"], [4, 1, 1, "", "on_predict_step_end"], [4, 1, 1, "", "on_predict_step_start"], [4, 1, 1, "", "on_train_end"], [4, 1, 1, "", "on_train_epoch_end"], [4, 1, 1, "", "on_train_epoch_start"], [4, 1, 1, "", "on_train_get_next_batch_end"], [4, 1, 1, "", "on_train_start"], [4, 1, 1, "", "on_train_step_end"], [4, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks": [[7, 0, 1, "", "BaseCSVWriter"], [8, 0, 1, "", "EarlyStopping"], [9, 0, 1, "", "GarbageCollector"], [10, 0, 1, "", "IterationTimeLogger"], [11, 0, 1, "", "Lambda"], [12, 0, 1, "", "LearningRateMonitor"], [13, 0, 1, "", "MemorySnapshot"], [14, 0, 1, "", "ModuleSummary"], [15, 0, 1, "", "PyTorchProfiler"], [16, 0, 1, "", "SystemResourcesMonitor"], [17, 0, 1, "", "TQDMProgressBar"], [18, 0, 1, "", "TensorBoardParameterMonitor"], [19, 0, 1, "", "TimeLimitInterrupter"], [20, 0, 1, "", "TorchSnapshotSaver"], [21, 0, 1, "", "TrainProgressMonitor"]], "torchtnt.framework.callbacks.BaseCSVWriter": [[7, 1, 1, "", "on_exception"], [7, 1, 1, "", "on_predict_end"], [7, 1, 1, "", "on_predict_start"], [7, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.EarlyStopping": [[8, 1, 1, "", "on_train_epoch_end"], [8, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.GarbageCollector": [[9, 1, 1, "", "on_eval_end"], [9, 1, 1, "", "on_eval_start"], [9, 1, 1, "", "on_eval_step_end"], [9, 1, 1, "", "on_predict_end"], [9, 1, 1, "", "on_predict_start"], [9, 1, 1, "", "on_predict_step_end"], [9, 1, 1, "", "on_train_end"], [9, 1, 1, "", "on_train_start"], [9, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.IterationTimeLogger": [[10, 1, 1, "", "on_eval_step_end"], [10, 1, 1, "", "on_predict_step_end"], [10, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.LearningRateMonitor": [[12, 1, 1, "", "on_train_epoch_start"], [12, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.MemorySnapshot": [[13, 1, 1, "", "on_eval_step_end"], [13, 1, 1, "", "on_predict_step_end"], [13, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.ModuleSummary": [[14, 1, 1, "", "on_eval_start"], [14, 1, 1, "", "on_predict_start"], [14, 1, 1, "", "on_train_start"]], "torchtnt.framework.callbacks.PyTorchProfiler": [[15, 1, 1, "", "on_eval_end"], [15, 1, 1, "", "on_eval_start"], [15, 1, 1, "", "on_eval_step_end"], [15, 1, 1, "", "on_predict_end"], [15, 1, 1, "", "on_predict_start"], [15, 1, 1, "", "on_predict_step_end"], [15, 1, 1, "", "on_train_end"], [15, 1, 1, "", "on_train_start"], [15, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SystemResourcesMonitor": [[16, 1, 1, "", "on_eval_epoch_start"], [16, 1, 1, "", "on_eval_step_start"], [16, 1, 1, "", "on_predict_epoch_start"], [16, 1, 1, "", "on_predict_step_start"], [16, 1, 1, "", "on_train_epoch_start"], [16, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.TQDMProgressBar": [[17, 1, 1, "", "on_eval_epoch_end"], [17, 1, 1, "", "on_eval_epoch_start"], [17, 1, 1, "", "on_eval_step_end"], [17, 1, 1, "", "on_predict_epoch_end"], [17, 1, 1, "", "on_predict_epoch_start"], [17, 1, 1, "", "on_predict_step_end"], [17, 1, 1, "", "on_train_epoch_end"], [17, 1, 1, "", "on_train_epoch_start"], [17, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TensorBoardParameterMonitor": [[18, 1, 1, "", "on_train_epoch_end"]], "torchtnt.framework.callbacks.TimeLimitInterrupter": [[19, 1, 1, "", "on_train_epoch_end"], [19, 1, 1, "", "on_train_start"], [19, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[20, 1, 1, "", "on_exception"], [20, 1, 1, "", "on_train_start"], [20, 1, 1, "", "restore"]], "torchtnt.framework.callbacks.TrainProgressMonitor": [[21, 1, 1, "", "on_train_epoch_end"], [21, 1, 1, "", "on_train_start"]], "torchtnt.framework.evaluate": [[5, 4, 1, "", "evaluate"]], "torchtnt.framework.fit": [[6, 4, 1, "", "fit"]], "torchtnt.framework.predict": [[22, 4, 1, "", "predict"]], "torchtnt.framework.state": [[23, 0, 1, "", "PhaseState"], [23, 0, 1, "", "State"]], "torchtnt.framework.state.PhaseState": [[23, 3, 1, "", "dataloader"], [23, 3, 1, "", "evaluate_every_n_epochs"], [23, 3, 1, "", "evaluate_every_n_steps"], [23, 3, 1, "", "iteration_timer"], [23, 3, 1, "", "max_epochs"], [23, 3, 1, "", "max_steps"], [23, 3, 1, "", "max_steps_per_epoch"], [23, 3, 1, "", "step_output"]], "torchtnt.framework.state.State": [[23, 3, 1, "", "active_phase"], [23, 3, 1, "", "entry_point"], [23, 3, 1, "", "eval_state"], [23, 3, 1, "", "predict_state"], [23, 3, 1, "", "should_stop"], [23, 1, 1, "", "stop"], [23, 3, 1, "", "timer"], [23, 3, 1, "", "train_state"]], "torchtnt.framework.train": [[24, 4, 1, "", "train"]], "torchtnt.framework.unit": [[25, 0, 1, "", "EvalUnit"], [25, 0, 1, "", "PredictUnit"], [25, 0, 1, "", "TrainUnit"]], "torchtnt.framework.unit.EvalUnit": [[25, 1, 1, "", "eval_step"], [25, 1, 1, "", "get_next_eval_batch"], [25, 1, 1, "", "on_eval_end"], [25, 1, 1, "", "on_eval_epoch_end"], [25, 1, 1, "", "on_eval_epoch_start"], [25, 1, 1, "", "on_eval_start"]], "torchtnt.framework.unit.PredictUnit": [[25, 1, 1, "", "get_next_predict_batch"], [25, 1, 1, "", "on_predict_end"], [25, 1, 1, "", "on_predict_epoch_end"], [25, 1, 1, "", "on_predict_epoch_start"], [25, 1, 1, "", "on_predict_start"], [25, 1, 1, "", "predict_step"]], "torchtnt.framework.unit.TrainUnit": [[25, 1, 1, "", "get_next_train_batch"], [25, 1, 1, "", "on_train_end"], [25, 1, 1, "", "on_train_epoch_end"], [25, 1, 1, "", "on_train_epoch_start"], [25, 1, 1, "", "on_train_start"], [25, 1, 1, "", "train_step"]], "torchtnt.utils.data": [[28, 0, 1, "", "AbstractRandomDataset"], [29, 0, 1, "", "AllDatasetBatchesIterator"], [30, 0, 1, "", "CudaDataPrefetcher"], [31, 0, 1, "", "InOrderIterator"], [32, 0, 1, "", "MultiDataLoader"], [33, 0, 1, "", "MultiIterator"], [34, 0, 1, "", "RandomizedBatchSamplerIterator"], [35, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.AbstractRandomDataset": [[28, 1, 1, "", "__init__"], [28, 5, 1, "", "size"]], "torchtnt.utils.data.AllDatasetBatchesIterator": [[29, 1, 1, "", "__init__"]], "torchtnt.utils.data.CudaDataPrefetcher": [[30, 1, 1, "", "__init__"]], "torchtnt.utils.data.InOrderIterator": [[31, 1, 1, "", "__init__"]], "torchtnt.utils.data.MultiDataLoader": [[32, 1, 1, "", "__init__"], [32, 5, 1, "", "ignore_empty_data"], [32, 5, 1, "", "individual_dataloaders"], [32, 5, 1, "", "iteration_strategy"], [32, 5, 1, "", "iterator_cls"]], "torchtnt.utils.data.MultiIterator": [[33, 1, 1, "", "__init__"]], "torchtnt.utils.data.RandomizedBatchSamplerIterator": [[34, 1, 1, "", "__init__"]], "torchtnt.utils.data.RoundRobinIterator": [[35, 1, 1, "", "__init__"]], "torchtnt.utils.device": [[36, 4, 1, "", "copy_data_to_device"], [37, 4, 1, "", "get_device_from_env"], [38, 4, 1, "", "get_nvidia_smi_gpu_stats"], [39, 4, 1, "", "get_psutil_cpu_stats"], [40, 4, 1, "", "record_data_in_stream"], [41, 4, 1, "", "set_float32_precision"]], "torchtnt.utils.distributed": [[42, 0, 1, "", "PGWrapper"], [43, 4, 1, "", "all_gather_tensors"], [44, 4, 1, "", "barrier"], [45, 4, 1, "", "destroy_process_group"], [46, 4, 1, "", "get_file_init_method"], [47, 4, 1, "", "get_global_rank"], [48, 4, 1, "", "get_local_rank"], [49, 4, 1, "", "get_process_group_backend_from_device"], [50, 4, 1, "", "get_tcp_init_method"], [51, 4, 1, "", "get_world_size"], [52, 4, 1, "", "rank_zero_fn"], [53, 4, 1, "", "revert_sync_batchnorm"], [54, 4, 1, "", "spawn_multi_process"], [55, 4, 1, "", "sync_bool"]], "torchtnt.utils.distributed.PGWrapper": [[42, 1, 1, "", "__init__"]], "torchtnt.utils.early_stop_checker": [[56, 0, 1, "", "EarlyStopChecker"]], "torchtnt.utils.early_stop_checker.EarlyStopChecker": [[56, 1, 1, "", "__init__"]], "torchtnt.utils.env": [[57, 4, 1, "", "init_from_env"], [58, 4, 1, "", "seed"]], "torchtnt.utils.flops": [[59, 0, 1, "", "FlopTensorDispatchMode"]], "torchtnt.utils.flops.FlopTensorDispatchMode": [[59, 1, 1, "", "__init__"]], "torchtnt.utils.fsspec": [[60, 4, 1, "", "get_filesystem"]], "torchtnt.utils.loggers": [[61, 0, 1, "", "CSVLogger"], [62, 0, 1, "", "FileLogger"], [63, 0, 1, "", "InMemoryLogger"], [64, 0, 1, "", "JSONLogger"], [65, 0, 1, "", "MetricLogger"], [66, 0, 1, "", "StdoutLogger"], [67, 0, 1, "", "TensorBoardLogger"]], "torchtnt.utils.loggers.CSVLogger": [[61, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.FileLogger": [[62, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.InMemoryLogger": [[63, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.JSONLogger": [[64, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.MetricLogger": [[65, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.StdoutLogger": [[66, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.TensorBoardLogger": [[67, 1, 1, "", "__init__"]], "torchtnt.utils.memory": [[68, 0, 1, "", "RSSProfiler"], [69, 4, 1, "", "measure_rss_deltas"]], "torchtnt.utils.memory.RSSProfiler": [[68, 1, 1, "", "__init__"], [68, 5, 1, "", "interval"], [68, 5, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.memory_snapshot_profiler": [[70, 0, 1, "", "MemorySnapshotProfiler"]], "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler": [[70, 1, 1, "", "__init__"]], "torchtnt.utils.misc": [[71, 4, 1, "", "days_to_secs"], [72, 4, 1, "", "transfer_batch_norm_stats"]], "torchtnt.utils.module_summary": [[73, 0, 1, "", "ModuleSummary"], [74, 4, 1, "", "get_module_summary"], [75, 4, 1, "", "get_summary_table"], [76, 4, 1, "", "prune_module_summary"]], "torchtnt.utils.module_summary.ModuleSummary": [[73, 1, 1, "", "__init__"]], "torchtnt.utils.oom": [[77, 4, 1, "", "attach_oom_observer"], [78, 4, 1, "", "is_out_of_cpu_memory"], [79, 4, 1, "", "is_out_of_cuda_memory"], [80, 4, 1, "", "is_out_of_memory_error"], [81, 4, 1, "", "log_memory_snapshot"]], "torchtnt.utils.optimizer": [[82, 4, 1, "", "init_optim_state"]], "torchtnt.utils.precision": [[83, 4, 1, "", "convert_precision_str_to_dtype"]], "torchtnt.utils.prepare_module": [[84, 0, 1, "", "DDPStrategy"], [85, 0, 1, "", "FSDPStrategy"], [86, 4, 1, "", "convert_str_to_strategy"], [87, 4, 1, "", "prepare_ddp"], [88, 4, 1, "", "prepare_fsdp"], [89, 4, 1, "", "prepare_module"]], "torchtnt.utils.prepare_module.DDPStrategy": [[84, 1, 1, "", "__init__"]], "torchtnt.utils.prepare_module.FSDPStrategy": [[85, 1, 1, "", "__init__"]], "torchtnt.utils.progress": [[90, 0, 1, "", "Progress"], [91, 4, 1, "", "estimated_steps_in_epoch"], [92, 4, 1, "", "estimated_steps_in_fit"], [93, 4, 1, "", "estimated_steps_in_loop"]], "torchtnt.utils.progress.Progress": [[90, 1, 1, "", "__init__"]], "torchtnt.utils.rank_zero_log": [[94, 4, 1, "", "rank_zero_critical"], [95, 4, 1, "", "rank_zero_debug"], [96, 4, 1, "", "rank_zero_error"], [97, 4, 1, "", "rank_zero_info"], [98, 4, 1, "", "rank_zero_print"], [99, 4, 1, "", "rank_zero_warn"]], "torchtnt.utils.stateful": [[100, 0, 1, "", "MultiStateful"], [101, 0, 1, "", "Stateful"]], "torchtnt.utils.stateful.MultiStateful": [[100, 1, 1, "", "__init__"]], "torchtnt.utils.stateful.Stateful": [[101, 1, 1, "", "__init__"]], "torchtnt.utils.swa": [[102, 0, 1, "", "AveragedModel"]], "torchtnt.utils.swa.AveragedModel": [[102, 1, 1, "", "__init__"]], "torchtnt.utils.test_utils": [[103, 4, 1, "", "get_pet_launch_config"], [104, 4, 1, "", "is_asan"], [105, 4, 1, "", "is_tsan"], [106, 4, 1, "", "skip_if_asan"]], "torchtnt.utils.timer": [[107, 0, 1, "", "BoundedTimer"], [108, 0, 1, "", "FullSyncPeriodicTimer"], [109, 0, 1, "", "Timer"], [110, 0, 1, "", "TimerProtocol"], [111, 4, 1, "", "get_durations_histogram"], [112, 4, 1, "", "get_recorded_durations_table"], [113, 4, 1, "", "get_synced_durations_histogram"], [114, 4, 1, "", "get_synced_timer_histogram"], [115, 4, 1, "", "get_timer_summary"], [116, 4, 1, "", "log_elapsed_time"]], "torchtnt.utils.timer.BoundedTimer": [[107, 1, 1, "", "__init__"]], "torchtnt.utils.timer.FullSyncPeriodicTimer": [[108, 1, 1, "", "__init__"]], "torchtnt.utils.timer.Timer": [[109, 1, 1, "", "__init__"]], "torchtnt.utils.timer.TimerProtocol": [[110, 1, 1, "", "__init__"]], "torchtnt.utils.tqdm": [[117, 4, 1, "", "close_progress_bar"], [118, 4, 1, "", "create_progress_bar"], [119, 4, 1, "", "update_progress_bar"]], "torchtnt.utils.version": [[120, 4, 1, "", "get_python_version"], [121, 4, 1, "", "get_torch_version"], [122, 4, 1, "", "is_windows"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:module", "3": "py:property", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "module", "Python module"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"checkpoint": 0, "fulli": [0, 1], "shard": [0, 1], "data": [0, 1, 28, 29, 30, 31, 32, 33, 34, 35, 123], "parallel": [0, 1], "finetun": 0, "best": 0, "model": [0, 27], "metric": 0, "distribut": [1, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 123], "train": [1, 2, 24, 27], "exampl": [2, 26], "trainunit": [2, 25], "autounit": [2, 3], "torchdata": 2, "mnist": 2, "mingpt": 2, "torchrec": 2, "callback": [4, 27], "built": 4, "evalu": 5, "entri": [5, 6, 22, 24], "point": [5, 6, 22, 24], "fit": 6, "basecsvwrit": 7, "earlystop": 8, "garbagecollector": 9, "iterationtimelogg": 10, "lambda": 11, "learningratemonitor": 12, "memorysnapshot": 13, "modulesummari": [14, 73], "pytorchprofil": 15, "systemresourcesmonitor": 16, "tqdmprogressbar": 17, "tensorboardparametermonitor": 18, "timelimitinterrupt": 19, "torchsnapshotsav": 20, "trainprogressmonitor": 21, "predict": 22, "state": [23, 100, 101, 123], "phasest": 23, "unit": 25, "evalunit": 25, "predictunit": 25, "combin": 25, "multipl": 25, "welcom": 26, "torchtnt": [26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122], "document": 26, "instal": 26, "overview": [26, 27], "core": [26, 27], "concept": 26, "framework": [26, 27], "util": [26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123], "function": 27, "api": 27, "organ": 27, "your": 27, "code": 27, "abstractrandomdataset": 28, "alldatasetbatchesiter": 29, "cudadataprefetch": 30, "inorderiter": 31, "multidataload": 32, "multiiter": 33, "randomizedbatchsampleriter": 34, "roundrobiniter": 35, "devic": [36, 37, 38, 39, 40, 41, 123], "copy_data_to_devic": 36, "get_device_from_env": 37, "get_nvidia_smi_gpu_stat": 38, "get_psutil_cpu_stat": 39, "record_data_in_stream": 40, "set_float32_precis": 41, "pgwrapper": 42, "all_gather_tensor": 43, "barrier": 44, "destroy_process_group": 45, "get_file_init_method": 46, "get_global_rank": 47, "get_local_rank": 48, "get_process_group_backend_from_devic": 49, "get_tcp_init_method": 50, "get_world_s": 51, "rank_zero_fn": 52, "revert_sync_batchnorm": 53, "spawn_multi_process": 54, "sync_bool": 55, "early_stop_check": 56, "earlystopcheck": 56, "env": [57, 58], "init_from_env": 57, "seed": 58, "flop": [59, 123], "floptensordispatchmod": 59, "fsspec": 60, "get_filesystem": 60, "logger": [61, 62, 63, 64, 65, 66, 67, 123], "csvlogger": 61, "filelogg": 62, "inmemorylogg": 63, "jsonlogg": 64, "metriclogg": 65, "stdoutlogg": 66, "tensorboardlogg": 67, "memori": [68, 69, 123], "rssprofil": 68, "measure_rss_delta": 69, "memory_snapshot_profil": 70, "memorysnapshotprofil": [70, 123], "misc": [71, 72, 123], "days_to_sec": 71, "transfer_batch_norm_stat": 72, "module_summari": [73, 74, 75, 76], "get_module_summari": 74, "get_summary_t": 75, "prune_module_summari": 76, "oom": [77, 78, 79, 80, 81, 123], "attach_oom_observ": 77, "is_out_of_cpu_memori": 78, "is_out_of_cuda_memori": 79, "is_out_of_memory_error": 80, "log_memory_snapshot": 81, "optim": [82, 123], "init_optim_st": 82, "precis": [83, 123], "convert_precision_str_to_dtyp": 83, "prepare_modul": [84, 85, 86, 87, 88, 89], "ddpstrategi": 84, "fsdpstrategi": 85, "convert_str_to_strategi": 86, "prepare_ddp": 87, "prepare_fsdp": 88, "progress": [90, 91, 92, 93, 123], "estimated_steps_in_epoch": 91, "estimated_steps_in_fit": 92, "estimated_steps_in_loop": 93, "rank_zero_log": [94, 95, 96, 97, 98, 99], "rank_zero_crit": 94, "rank_zero_debug": 95, "rank_zero_error": 96, "rank_zero_info": 97, "rank_zero_print": 98, "rank_zero_warn": 99, "multist": 100, "swa": [102, 123], "averagedmodel": 102, "test_util": [103, 104, 105, 106], "get_pet_launch_config": 103, "is_asan": 104, "is_tsan": 105, "skip_if_asan": 106, "timer": [107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 123], "boundedtim": 107, "fullsyncperiodictim": 108, "timerprotocol": 110, "get_durations_histogram": 111, "get_recorded_durations_t": 112, "get_synced_durations_histogram": 113, "get_synced_timer_histogram": 114, "get_timer_summari": 115, "log_elapsed_tim": 116, "tqdm": [117, 118, 119, 123], "close_progress_bar": 117, "create_progress_bar": 118, "update_progress_bar": 119, "version": [120, 121, 122, 123], "get_python_vers": 120, "get_torch_vers": 121, "is_window": 122, "earli": 123, "stop": 123, "checker": 123, "environ": 123, "filesystem": 123, "spec": 123, "modul": 123, "summari": 123, "prepar": 123, "rank": 123, "zero": 123, "log": 123, "test": 123}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 56}})