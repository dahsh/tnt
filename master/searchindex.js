Search.setIndex({"docnames": ["checkpointing", "distributed", "examples", "framework/auto_unit", "framework/callbacks", "framework/eval", "framework/fit", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter", "framework/generated/torchtnt.framework.callbacks.GarbageCollector", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger", "framework/generated/torchtnt.framework.callbacks.Lambda", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot", "framework/generated/torchtnt.framework.callbacks.ModuleSummary", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor", "framework/predict", "framework/state", "framework/train", "framework/unit", "index", "overview", "utils/generated/torchtnt.utils.data.AbstractRandomDataset", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher", "utils/generated/torchtnt.utils.data.InOrderIterator", "utils/generated/torchtnt.utils.data.MultiDataLoader", "utils/generated/torchtnt.utils.data.MultiIterator", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator", "utils/generated/torchtnt.utils.data.RoundRobinIterator", "utils/generated/torchtnt.utils.device.copy_data_to_device", "utils/generated/torchtnt.utils.device.get_device_from_env", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats", "utils/generated/torchtnt.utils.device.record_data_in_stream", "utils/generated/torchtnt.utils.device.set_float32_precision", "utils/generated/torchtnt.utils.distributed.PGWrapper", "utils/generated/torchtnt.utils.distributed.all_gather_tensors", "utils/generated/torchtnt.utils.distributed.barrier", "utils/generated/torchtnt.utils.distributed.destroy_process_group", "utils/generated/torchtnt.utils.distributed.get_file_init_method", "utils/generated/torchtnt.utils.distributed.get_global_rank", "utils/generated/torchtnt.utils.distributed.get_local_rank", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method", "utils/generated/torchtnt.utils.distributed.get_world_size", "utils/generated/torchtnt.utils.distributed.rank_zero_fn", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm", "utils/generated/torchtnt.utils.distributed.spawn_multi_process", "utils/generated/torchtnt.utils.distributed.sync_bool", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker", "utils/generated/torchtnt.utils.env.init_from_env", "utils/generated/torchtnt.utils.env.seed", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode", "utils/generated/torchtnt.utils.fsspec.get_filesystem", "utils/generated/torchtnt.utils.loggers.CSVLogger", "utils/generated/torchtnt.utils.loggers.FileLogger", "utils/generated/torchtnt.utils.loggers.InMemoryLogger", "utils/generated/torchtnt.utils.loggers.JSONLogger", "utils/generated/torchtnt.utils.loggers.MetricLogger", "utils/generated/torchtnt.utils.loggers.StdoutLogger", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger", "utils/generated/torchtnt.utils.memory.RSSProfiler", "utils/generated/torchtnt.utils.memory.measure_rss_deltas", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "utils/generated/torchtnt.utils.misc.days_to_secs", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats", "utils/generated/torchtnt.utils.module_summary.ModuleSummary", "utils/generated/torchtnt.utils.module_summary.get_module_summary", "utils/generated/torchtnt.utils.module_summary.get_summary_table", "utils/generated/torchtnt.utils.module_summary.prune_module_summary", "utils/generated/torchtnt.utils.oom.attach_oom_observer", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error", "utils/generated/torchtnt.utils.oom.log_memory_snapshot", "utils/generated/torchtnt.utils.optimizer.init_optim_state", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp", "utils/generated/torchtnt.utils.prepare_module.prepare_module", "utils/generated/torchtnt.utils.progress.Progress", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn", "utils/generated/torchtnt.utils.stateful.MultiStateful", "utils/generated/torchtnt.utils.stateful.Stateful", "utils/generated/torchtnt.utils.swa.AveragedModel", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config", "utils/generated/torchtnt.utils.test_utils.is_asan", "utils/generated/torchtnt.utils.test_utils.is_tsan", "utils/generated/torchtnt.utils.test_utils.skip_if_asan", "utils/generated/torchtnt.utils.timer.BoundedTimer", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer", "utils/generated/torchtnt.utils.timer.Timer", "utils/generated/torchtnt.utils.timer.TimerProtocol", "utils/generated/torchtnt.utils.timer.get_durations_histogram", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram", "utils/generated/torchtnt.utils.timer.get_timer_summary", "utils/generated/torchtnt.utils.timer.log_elapsed_time", "utils/generated/torchtnt.utils.tqdm.close_progress_bar", "utils/generated/torchtnt.utils.tqdm.create_progress_bar", "utils/generated/torchtnt.utils.tqdm.update_progress_bar", "utils/generated/torchtnt.utils.version.get_python_version", "utils/generated/torchtnt.utils.version.get_torch_version", "utils/generated/torchtnt.utils.version.is_windows", "utils/utils"], "filenames": ["checkpointing.rst", "distributed.rst", "examples.rst", "framework/auto_unit.rst", "framework/callbacks.rst", "framework/eval.rst", "framework/fit.rst", "framework/generated/torchtnt.framework.callbacks.BaseCSVWriter.rst", "framework/generated/torchtnt.framework.callbacks.GarbageCollector.rst", "framework/generated/torchtnt.framework.callbacks.IterationTimeLogger.rst", "framework/generated/torchtnt.framework.callbacks.Lambda.rst", "framework/generated/torchtnt.framework.callbacks.LearningRateMonitor.rst", "framework/generated/torchtnt.framework.callbacks.MemorySnapshot.rst", "framework/generated/torchtnt.framework.callbacks.ModuleSummary.rst", "framework/generated/torchtnt.framework.callbacks.PyTorchProfiler.rst", "framework/generated/torchtnt.framework.callbacks.SystemResourcesMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TQDMProgressBar.rst", "framework/generated/torchtnt.framework.callbacks.TensorBoardParameterMonitor.rst", "framework/generated/torchtnt.framework.callbacks.TorchSnapshotSaver.rst", "framework/generated/torchtnt.framework.callbacks.TrainProgressMonitor.rst", "framework/predict.rst", "framework/state.rst", "framework/train.rst", "framework/unit.rst", "index.rst", "overview.rst", "utils/generated/torchtnt.utils.data.AbstractRandomDataset.rst", "utils/generated/torchtnt.utils.data.AllDatasetBatchesIterator.rst", "utils/generated/torchtnt.utils.data.CudaDataPrefetcher.rst", "utils/generated/torchtnt.utils.data.InOrderIterator.rst", "utils/generated/torchtnt.utils.data.MultiDataLoader.rst", "utils/generated/torchtnt.utils.data.MultiIterator.rst", "utils/generated/torchtnt.utils.data.RandomizedBatchSamplerIterator.rst", "utils/generated/torchtnt.utils.data.RoundRobinIterator.rst", "utils/generated/torchtnt.utils.device.copy_data_to_device.rst", "utils/generated/torchtnt.utils.device.get_device_from_env.rst", "utils/generated/torchtnt.utils.device.get_nvidia_smi_gpu_stats.rst", "utils/generated/torchtnt.utils.device.get_psutil_cpu_stats.rst", "utils/generated/torchtnt.utils.device.record_data_in_stream.rst", "utils/generated/torchtnt.utils.device.set_float32_precision.rst", "utils/generated/torchtnt.utils.distributed.PGWrapper.rst", "utils/generated/torchtnt.utils.distributed.all_gather_tensors.rst", "utils/generated/torchtnt.utils.distributed.barrier.rst", "utils/generated/torchtnt.utils.distributed.destroy_process_group.rst", "utils/generated/torchtnt.utils.distributed.get_file_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_global_rank.rst", "utils/generated/torchtnt.utils.distributed.get_local_rank.rst", "utils/generated/torchtnt.utils.distributed.get_process_group_backend_from_device.rst", "utils/generated/torchtnt.utils.distributed.get_tcp_init_method.rst", "utils/generated/torchtnt.utils.distributed.get_world_size.rst", "utils/generated/torchtnt.utils.distributed.rank_zero_fn.rst", "utils/generated/torchtnt.utils.distributed.revert_sync_batchnorm.rst", "utils/generated/torchtnt.utils.distributed.spawn_multi_process.rst", "utils/generated/torchtnt.utils.distributed.sync_bool.rst", "utils/generated/torchtnt.utils.early_stop_checker.EarlyStopChecker.rst", "utils/generated/torchtnt.utils.env.init_from_env.rst", "utils/generated/torchtnt.utils.env.seed.rst", "utils/generated/torchtnt.utils.flops.FlopTensorDispatchMode.rst", "utils/generated/torchtnt.utils.fsspec.get_filesystem.rst", "utils/generated/torchtnt.utils.loggers.CSVLogger.rst", "utils/generated/torchtnt.utils.loggers.FileLogger.rst", "utils/generated/torchtnt.utils.loggers.InMemoryLogger.rst", "utils/generated/torchtnt.utils.loggers.JSONLogger.rst", "utils/generated/torchtnt.utils.loggers.MetricLogger.rst", "utils/generated/torchtnt.utils.loggers.StdoutLogger.rst", "utils/generated/torchtnt.utils.loggers.TensorBoardLogger.rst", "utils/generated/torchtnt.utils.memory.RSSProfiler.rst", "utils/generated/torchtnt.utils.memory.measure_rss_deltas.rst", "utils/generated/torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler.rst", "utils/generated/torchtnt.utils.misc.days_to_secs.rst", "utils/generated/torchtnt.utils.misc.transfer_batch_norm_stats.rst", "utils/generated/torchtnt.utils.module_summary.ModuleSummary.rst", "utils/generated/torchtnt.utils.module_summary.get_module_summary.rst", "utils/generated/torchtnt.utils.module_summary.get_summary_table.rst", "utils/generated/torchtnt.utils.module_summary.prune_module_summary.rst", "utils/generated/torchtnt.utils.oom.attach_oom_observer.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cpu_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_cuda_memory.rst", "utils/generated/torchtnt.utils.oom.is_out_of_memory_error.rst", "utils/generated/torchtnt.utils.oom.log_memory_snapshot.rst", "utils/generated/torchtnt.utils.optimizer.init_optim_state.rst", "utils/generated/torchtnt.utils.precision.convert_precision_str_to_dtype.rst", "utils/generated/torchtnt.utils.prepare_module.DDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.FSDPStrategy.rst", "utils/generated/torchtnt.utils.prepare_module.convert_str_to_strategy.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_ddp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_fsdp.rst", "utils/generated/torchtnt.utils.prepare_module.prepare_module.rst", "utils/generated/torchtnt.utils.progress.Progress.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_epoch.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_fit.rst", "utils/generated/torchtnt.utils.progress.estimated_steps_in_loop.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_critical.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_debug.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_error.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_info.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_print.rst", "utils/generated/torchtnt.utils.rank_zero_log.rank_zero_warn.rst", "utils/generated/torchtnt.utils.stateful.MultiStateful.rst", "utils/generated/torchtnt.utils.stateful.Stateful.rst", "utils/generated/torchtnt.utils.swa.AveragedModel.rst", "utils/generated/torchtnt.utils.test_utils.get_pet_launch_config.rst", "utils/generated/torchtnt.utils.test_utils.is_asan.rst", "utils/generated/torchtnt.utils.test_utils.is_tsan.rst", "utils/generated/torchtnt.utils.test_utils.skip_if_asan.rst", "utils/generated/torchtnt.utils.timer.BoundedTimer.rst", "utils/generated/torchtnt.utils.timer.FullSyncPeriodicTimer.rst", "utils/generated/torchtnt.utils.timer.Timer.rst", "utils/generated/torchtnt.utils.timer.TimerProtocol.rst", "utils/generated/torchtnt.utils.timer.get_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_recorded_durations_table.rst", "utils/generated/torchtnt.utils.timer.get_synced_durations_histogram.rst", "utils/generated/torchtnt.utils.timer.get_synced_timer_histogram.rst", "utils/generated/torchtnt.utils.timer.get_timer_summary.rst", "utils/generated/torchtnt.utils.timer.log_elapsed_time.rst", "utils/generated/torchtnt.utils.tqdm.close_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.create_progress_bar.rst", "utils/generated/torchtnt.utils.tqdm.update_progress_bar.rst", "utils/generated/torchtnt.utils.version.get_python_version.rst", "utils/generated/torchtnt.utils.version.get_torch_version.rst", "utils/generated/torchtnt.utils.version.is_windows.rst", "utils/utils.rst"], "titles": ["Checkpointing", "Distributed training", "Examples", "AutoUnit", "Callbacks", "Evaluate", "Fit", "BaseCSVWriter", "GarbageCollector", "IterationTimeLogger", "Lambda", "LearningRateMonitor", "MemorySnapshot", "ModuleSummary", "PyTorchProfiler", "SystemResourcesMonitor", "TQDMProgressBar", "TensorBoardParameterMonitor", "TorchSnapshotSaver", "TrainProgressMonitor", "Predict", "State", "Train", "Unit", "Welcome to the TorchTNT documentation!", "Overview", "torchtnt.utils.data.AbstractRandomDataset", "torchtnt.utils.data.AllDatasetBatchesIterator", "torchtnt.utils.data.CudaDataPrefetcher", "torchtnt.utils.data.InOrderIterator", "torchtnt.utils.data.MultiDataLoader", "torchtnt.utils.data.MultiIterator", "torchtnt.utils.data.RandomizedBatchSamplerIterator", "torchtnt.utils.data.RoundRobinIterator", "torchtnt.utils.device.copy_data_to_device", "torchtnt.utils.device.get_device_from_env", "torchtnt.utils.device.get_nvidia_smi_gpu_stats", "torchtnt.utils.device.get_psutil_cpu_stats", "torchtnt.utils.device.record_data_in_stream", "torchtnt.utils.device.set_float32_precision", "torchtnt.utils.distributed.PGWrapper", "torchtnt.utils.distributed.all_gather_tensors", "torchtnt.utils.distributed.barrier", "torchtnt.utils.distributed.destroy_process_group", "torchtnt.utils.distributed.get_file_init_method", "torchtnt.utils.distributed.get_global_rank", "torchtnt.utils.distributed.get_local_rank", "torchtnt.utils.distributed.get_process_group_backend_from_device", "torchtnt.utils.distributed.get_tcp_init_method", "torchtnt.utils.distributed.get_world_size", "torchtnt.utils.distributed.rank_zero_fn", "torchtnt.utils.distributed.revert_sync_batchnorm", "torchtnt.utils.distributed.spawn_multi_process", "torchtnt.utils.distributed.sync_bool", "torchtnt.utils.early_stop_checker.EarlyStopChecker", "torchtnt.utils.env.init_from_env", "torchtnt.utils.env.seed", "torchtnt.utils.flops.FlopTensorDispatchMode", "torchtnt.utils.fsspec.get_filesystem", "torchtnt.utils.loggers.CSVLogger", "torchtnt.utils.loggers.FileLogger", "torchtnt.utils.loggers.InMemoryLogger", "torchtnt.utils.loggers.JSONLogger", "torchtnt.utils.loggers.MetricLogger", "torchtnt.utils.loggers.StdoutLogger", "torchtnt.utils.loggers.TensorBoardLogger", "torchtnt.utils.memory.RSSProfiler", "torchtnt.utils.memory.measure_rss_deltas", "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler", "torchtnt.utils.misc.days_to_secs", "torchtnt.utils.misc.transfer_batch_norm_stats", "torchtnt.utils.module_summary.ModuleSummary", "torchtnt.utils.module_summary.get_module_summary", "torchtnt.utils.module_summary.get_summary_table", "torchtnt.utils.module_summary.prune_module_summary", "torchtnt.utils.oom.attach_oom_observer", "torchtnt.utils.oom.is_out_of_cpu_memory", "torchtnt.utils.oom.is_out_of_cuda_memory", "torchtnt.utils.oom.is_out_of_memory_error", "torchtnt.utils.oom.log_memory_snapshot", "torchtnt.utils.optimizer.init_optim_state", "torchtnt.utils.precision.convert_precision_str_to_dtype", "torchtnt.utils.prepare_module.DDPStrategy", "torchtnt.utils.prepare_module.FSDPStrategy", "torchtnt.utils.prepare_module.convert_str_to_strategy", "torchtnt.utils.prepare_module.prepare_ddp", "torchtnt.utils.prepare_module.prepare_fsdp", "torchtnt.utils.prepare_module.prepare_module", "torchtnt.utils.progress.Progress", "torchtnt.utils.progress.estimated_steps_in_epoch", "torchtnt.utils.progress.estimated_steps_in_fit", "torchtnt.utils.progress.estimated_steps_in_loop", "torchtnt.utils.rank_zero_log.rank_zero_critical", "torchtnt.utils.rank_zero_log.rank_zero_debug", "torchtnt.utils.rank_zero_log.rank_zero_error", "torchtnt.utils.rank_zero_log.rank_zero_info", "torchtnt.utils.rank_zero_log.rank_zero_print", "torchtnt.utils.rank_zero_log.rank_zero_warn", "torchtnt.utils.stateful.MultiStateful", "torchtnt.utils.stateful.Stateful", "torchtnt.utils.swa.AveragedModel", "torchtnt.utils.test_utils.get_pet_launch_config", "torchtnt.utils.test_utils.is_asan", "torchtnt.utils.test_utils.is_tsan", "torchtnt.utils.test_utils.skip_if_asan", "torchtnt.utils.timer.BoundedTimer", "torchtnt.utils.timer.FullSyncPeriodicTimer", "torchtnt.utils.timer.Timer", "torchtnt.utils.timer.TimerProtocol", "torchtnt.utils.timer.get_durations_histogram", "torchtnt.utils.timer.get_recorded_durations_table", "torchtnt.utils.timer.get_synced_durations_histogram", "torchtnt.utils.timer.get_synced_timer_histogram", "torchtnt.utils.timer.get_timer_summary", "torchtnt.utils.timer.log_elapsed_time", "torchtnt.utils.tqdm.close_progress_bar", "torchtnt.utils.tqdm.create_progress_bar", "torchtnt.utils.tqdm.update_progress_bar", "torchtnt.utils.version.get_python_version", "torchtnt.utils.version.get_torch_version", "torchtnt.utils.version.is_windows", "Utils"], "terms": {"torchtnt": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25], "offer": [0, 1, 3, 4, 18, 23, 25], "via": [0, 33], "torchsnapshotsav": 0, "which": [0, 1, 3, 4, 5, 6, 9, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28, 30, 34, 38, 39, 51, 53, 54, 67, 68, 85, 86, 87, 105, 107, 113], "us": [0, 1, 2, 3, 4, 5, 6, 12, 13, 14, 18, 20, 21, 22, 23, 25, 28, 32, 37, 38, 39, 40, 42, 44, 45, 46, 48, 49, 50, 52, 53, 55, 56, 58, 65, 72, 80, 84, 87, 100, 111, 112, 116, 121], "torchsnapshot": [0, 18], "under": [0, 18, 23], "hood": 0, "modul": [0, 1, 3, 5, 6, 13, 17, 20, 22, 23, 24, 25, 51, 56, 57, 70, 71, 72, 74, 83, 85, 86, 87, 98, 100], "nn": [0, 1, 3, 23, 25, 51, 85, 86, 98], "linear": [0, 1, 25, 51, 85, 86], "input_dim": [0, 1], "1": [0, 1, 6, 8, 9, 16, 25, 27, 28, 29, 32, 33, 49, 50, 53, 54, 56, 57, 64, 72, 73, 74, 85, 86, 119], "unit": [0, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 24, 25], "myunit": [0, 10, 23, 25], "tss": 0, "dirpath": [0, 18], "your_dirpath_her": 0, "save_every_n_train_step": [0, 18], "100": [0, 26, 51, 59, 62, 109, 111, 112], "save_every_n_epoch": [0, 18], "2": [0, 3, 27, 28, 29, 32, 33, 53, 56, 64, 73], "load": [0, 1, 18, 28, 80, 99], "latest": [0, 24], "exist": [0, 18, 80], "latest_checkpoint_dir": 0, "restore_from_latest": 0, "train_dataload": [0, 4, 6, 18, 22, 25, 90], "dataload": [0, 3, 5, 6, 10, 18, 20, 21, 22, 23, 25, 27, 28, 29, 30, 31, 32, 33, 68, 89, 91, 116], "train": [0, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 65, 68, 90, 101, 106, 121], "callback": [0, 1, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 24], "There": [0, 18, 25], "built": [0, 25], "support": [0, 3, 27, 29, 30, 31, 33, 35, 53, 72], "save": [0, 7, 12, 18, 68, 75, 79, 98, 99], "distribut": [0, 8, 16, 18, 24, 25, 35, 55, 65, 84, 101], "ddp": [0, 1, 3, 25, 82, 85, 87], "fsdp": [0, 1, 3, 18, 25, 86, 87, 100], "The": [0, 1, 2, 3, 5, 6, 7, 8, 13, 18, 20, 22, 23, 25, 26, 34, 38, 39, 44, 51, 53, 55, 57, 64, 66, 67, 68, 72, 74, 75, 79, 100, 101, 105, 107, 109, 111, 112, 116], "state": [0, 3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 23, 24, 25, 50, 80], "dict": [0, 13, 18, 27, 29, 30, 36, 37, 52, 66, 80, 98, 109, 110, 111, 112], "type": [0, 13, 18, 23, 25, 26, 30, 36, 37, 41, 50, 55, 71], "can": [0, 1, 2, 3, 4, 5, 6, 8, 18, 20, 21, 22, 23, 24, 25, 28, 29, 31, 32, 33, 50, 65, 68, 121], "specifi": [0, 12, 16, 23, 25, 53, 68, 84, 100, 116], "fsdpstrategi": [0, 1, 3, 84, 86], "s": [0, 2, 3, 5, 6, 8, 18, 20, 22, 23, 30, 53, 55, 72, 112], "state_dict_typ": [0, 83], "argument": [0, 1, 3, 5, 6, 20, 22, 34, 52, 65, 72, 100], "like": [0, 1, 3, 18, 31, 38, 80, 100], "so": [0, 1, 3, 24, 64, 68, 116], "fsdp_strategi": [0, 1], "set": [0, 1, 5, 6, 15, 18, 20, 22, 27, 32, 35, 39, 46, 54, 55, 56, 64, 66, 67, 68, 73, 79, 85, 86, 87, 105, 107, 114], "sharded_state_dict": 0, "prepare_fsdp": [0, 1], "strategi": [0, 1, 3, 25, 33, 82, 83, 84, 85, 86, 87], "Or": 0, "you": [0, 1, 3, 18, 23, 24, 72], "manual": [0, 25], "thi": [0, 1, 3, 4, 6, 7, 8, 12, 18, 19, 23, 26, 27, 28, 29, 30, 32, 33, 35, 38, 41, 42, 48, 50, 51, 53, 54, 55, 56, 64, 65, 71, 75, 79, 80, 100, 105, 107], "set_state_dict_typ": [0, 18], "statedicttyp": [0, 83], "when": [0, 1, 2, 3, 4, 7, 10, 12, 13, 18, 19, 21, 27, 28, 38, 42, 54, 58, 66, 67, 75, 105, 107], "your": [0, 1, 4, 12, 23], "pass": [0, 1, 3, 4, 18, 23, 25, 30, 34, 59, 65, 72, 81, 84, 100, 109], "restoreopt": [0, 18], "avoid": [0, 38, 56, 106], "optim": [0, 3, 5, 6, 11, 20, 22, 23, 24, 25, 98, 100], "learn": [0, 3, 11, 23], "rate": [0, 3, 11, 16, 23], "schedul": [0, 3, 11, 23], "your_unit": 0, "restore_opt": [0, 18], "restore_optim": 0, "fals": [0, 1, 30, 59, 62, 68, 73, 82, 83, 100, 107], "restore_lr_schedul": 0, "sometim": 0, "mai": [0, 5, 6, 18, 20, 22, 41, 80, 98], "help": [0, 1, 19], "keep": [0, 13, 18, 68, 74], "track": [0, 5, 6, 11, 20, 22, 68, 88], "how": [0, 2, 3, 6, 23, 27, 29, 30, 31, 32, 33], "perform": [0, 3, 5, 6, 8, 18, 20, 22, 23, 105, 107], "done": [0, 5, 6, 20, 22, 27, 33, 106], "bestcheckpointconfig": [0, 18], "param": [0, 3, 18, 82, 87, 100], "best_checkpoint_config": [0, 18], "monitored_metr": 0, "train_loss": [0, 25], "mode": [0, 5, 6, 20, 22, 54, 104], "min": [0, 54], "By": [0, 7, 8, 18, 29, 32, 38], "monitor": [0, 18, 25, 54], "expect": [0, 1], "trainunit": [0, 1, 3, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 22, 25], "have": [0, 3, 18, 23, 25, 41, 51, 64, 98], "attribut": [0, 18, 26, 54, 59, 60, 61, 62, 65, 71, 82, 83, 88, 100, 105, 107, 108], "time": [0, 5, 6, 8, 9, 18, 20, 21, 22, 59, 69, 71, 80, 105, 106, 107, 108, 110, 114], "cast": 0, "valu": [0, 3, 18, 27, 29, 30, 31, 32, 33, 36, 37, 41, 52, 53, 55, 56, 64, 66, 72, 91, 109, 111, 112], "float": [0, 18, 25, 36, 37, 53, 54, 89, 100, 109, 110, 111, 112], "append": [0, 67, 79], "path": [0, 7, 18, 58, 59, 60, 62, 65], "name": [0, 4, 7, 13, 18, 27, 29, 30, 31, 32, 33, 59, 64, 66, 71, 109, 111, 112, 114], "comput": [0, 3, 25, 28, 109, 111, 112], "kept": [0, 18, 105, 107], "up": [0, 8, 21, 87], "date": 0, "appropri": [0, 18, 25, 35, 58], "user": [0, 1, 3, 12, 14, 18, 21, 23, 25, 28, 68, 100], "later": 0, "restore_from_best": 0, "metric_nam": 0, "If": [0, 1, 3, 13, 18, 23, 24, 35, 36, 42, 44, 48, 51, 53, 54, 55, 56, 65, 68, 72, 74, 79, 90, 100, 105, 107, 109, 111, 112, 113, 114], "d": [0, 51], "valid": [0, 18], "sai": 0, "loss": [0, 3, 23, 25, 64], "after": [0, 3, 4, 6, 7, 8, 9, 12, 14, 16, 17, 18, 19, 21, 23, 25, 32, 54, 64, 65, 80, 105, 107], "each": [0, 3, 7, 8, 10, 11, 18, 21, 23, 26, 32, 41, 64, 109, 111, 112], "eval": [0, 3, 4, 5, 6, 8, 9, 10, 12, 14, 15, 16, 18, 20, 21, 23, 25, 90], "epoch": [0, 3, 4, 5, 6, 10, 11, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 89, 90, 91, 116], "dure": [0, 3, 4, 5, 6, 7, 10, 12, 18, 20, 21, 22, 88], "fit": [0, 3, 4, 18, 21, 23, 24, 25, 90], "save_every_n_eval_epoch": [0, 18], "flag": [0, 18], "instead": [0, 18, 45, 49, 51], "eval_loss": 0, "And": 0, "onli": [0, 3, 16, 18, 21, 35, 38, 50, 53, 55, 59, 60, 62, 65, 72, 75, 79, 80, 92, 93, 94, 95, 96, 97, 98, 100], "top": [0, 18, 24, 25], "three": [0, 23, 25, 27], "keep_last_n_checkpoint": [0, 18], "3": [0, 21, 27, 29, 32, 33, 52, 53, 57, 118], "core": [1, 3, 23], "tnt": [1, 2, 24, 25], "framework": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 26, 121], "make": [1, 8, 12, 24, 53, 64], "assumpt": 1, "about": [1, 3, 21, 23, 38], "devic": [1, 3, 24, 25, 28, 47, 51, 55, 75, 79, 82, 85, 86, 87, 100], "handl": [1, 3, 25, 58], "configur": [1, 3, 8, 18], "own": [1, 4], "As": [1, 8, 38], "conveni": [1, 3, 8, 23, 55, 88], "autounit": [1, 24, 25], "who": [1, 3, 25], "prefer": [1, 25], "automat": [1, 3, 8, 25, 48, 100], "provid": [1, 7, 18, 26, 29, 30, 31, 32, 53, 79], "checkpoint": [1, 3, 4, 18, 24, 25, 80, 87, 88, 99], "model": [1, 2, 3, 4, 8, 12, 18, 23, 55, 57, 68, 70, 100], "ar": [1, 3, 4, 18, 23, 24, 25, 27, 29, 30, 31, 32, 33, 41, 52, 53, 59, 67, 68, 72, 74, 75, 79, 80, 100, 104, 109, 111, 112, 121], "evalunit": [1, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 25], "predictunit": [1, 3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 20, 25], "interfac": [1, 3, 7, 23, 25, 99], "initi": [1, 3, 12, 16, 18, 40, 42, 43, 44, 45, 48, 49, 53, 55, 57, 65, 66, 67, 80, 101], "cuda": [1, 5, 6, 15, 20, 22, 25, 28, 35, 38, 51, 75, 77, 79, 85, 86, 105, 107, 114], "applic": [1, 8, 18, 55], "along": [1, 109, 111, 112], "global": [1, 42, 43, 44, 48, 50, 55, 56, 111, 112], "process": [1, 7, 8, 18, 37, 40, 41, 42, 43, 47, 48, 52, 53, 55, 65, 101, 106, 111, 112], "group": [1, 11, 18, 41, 42, 43, 47, 53, 55, 65, 111, 112], "from": [1, 3, 4, 5, 6, 10, 13, 18, 20, 22, 23, 24, 25, 27, 29, 31, 32, 36, 38, 41, 47, 50, 55, 57, 61, 64, 65, 69, 80, 92, 93, 94, 95, 96, 97, 101, 106, 109, 111, 116], "torch": [1, 3, 5, 6, 9, 14, 17, 18, 20, 22, 23, 25, 27, 28, 29, 32, 33, 34, 35, 36, 38, 39, 42, 45, 49, 51, 53, 55, 56, 57, 81, 85, 86, 87, 100, 101, 105, 107], "we": [1, 4, 8, 25, 28, 38, 72, 98, 104], "function": [1, 3, 4, 10, 13, 23, 30, 31, 34, 35, 41, 42, 44, 47, 48, 50, 51, 52, 53, 55, 56, 72, 75, 80, 96, 101, 110], "init_from_env": 1, "work": [1, 41, 80], "torchelast": 1, "should": [1, 3, 4, 6, 7, 18, 23, 26, 28, 34, 50, 51, 53, 54, 65, 105, 107, 109, 111, 112], "invok": [1, 25, 42], "begin": [1, 19, 55], "script": [1, 12, 55], "simpli": 1, "wrap": [1, 42, 50, 85, 86, 100], "around": [1, 24, 25, 40], "move": [1, 9, 25, 28, 29, 85, 86, 87], "device_id": 1, "index": [1, 31, 35], "distributeddataparallel": [1, 82, 85], "also": [1, 3, 18, 24, 25, 30, 31, 35], "prepare_ddp": 1, "assist": 1, "either": [1, 3, 9, 11, 15, 17, 19, 23], "string": [1, 3, 7, 73, 81, 84, 87], "my_auto_unit": 1, "myautounit": 1, "dataclass": [1, 3, 27, 29, 30, 31, 32, 33, 82, 83, 84], "ddpstrategi": [1, 84, 85], "want": [1, 13, 18, 23, 25], "custom": [1, 3, 18, 23, 26, 29, 100], "ddp_strategi": 1, "broadcast_buff": [1, 82], "check_reduct": [1, 82], "true": [1, 3, 18, 53, 54, 59, 60, 62, 68, 73, 76, 77, 78, 82, 83, 85, 86, 100, 105, 107, 114], "one": [1, 3, 7, 23, 29, 33, 43, 51, 54, 55, 87, 98], "more": [1, 2, 3, 18, 25, 28, 30, 31, 39, 42, 44, 48, 51, 55, 56, 72, 75, 79, 100], "fullyshardeddataparallel": [1, 83, 86], "forward_prefetch": [1, 83], "limit_all_gath": [1, 83, 86], "show": 2, "basic": [2, 4, 23, 25], "It": [2, 12, 16, 24, 25, 30, 50, 68, 71], "found": [2, 36], "here": [2, 23, 25, 44, 48, 55], "http": [2, 3, 12, 17, 18, 24, 28, 31, 38, 39, 44, 46, 48, 55, 56, 57, 87, 100], "github": [2, 12, 24, 100], "com": [2, 24, 100], "pytorch": [2, 3, 5, 6, 14, 17, 18, 20, 22, 24, 25, 28, 31, 38, 39, 44, 46, 48, 55, 56, 57, 72, 75, 80, 87, 100, 119], "blob": [2, 100], "master": [2, 24], "train_unit_exampl": 2, "py": [2, 100], "less": [2, 68, 74], "code": [2, 3, 4, 8, 14, 23], "featur": 2, "enabl": [2, 3, 18, 50, 56, 87, 105, 107], "out": [2, 4, 75, 100], "box": [2, 4], "auto_unit_exampl": 2, "datapip": 2, "dataloader2": [2, 5, 6, 20, 22], "torchdata_train_exampl": 2, "convnet": 2, "dataset": [2, 3, 19, 23, 26, 27, 29, 32, 33], "main": [2, 18, 24, 25, 100], "class": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 23, 25, 26, 27, 28, 29, 30, 31, 32, 33, 40, 54, 57, 59, 60, 61, 62, 63, 64, 65, 66, 68, 71, 82, 83, 88, 98, 99, 100, 105, 106, 107, 108], "auto_unit": 3, "arg": [3, 10, 13, 25, 34, 52, 63, 65, 92, 93, 94, 95, 96, 97, 99, 108], "kwarg": [3, 13, 34, 52, 58, 63, 65, 72, 92, 93, 94, 95, 96, 97, 99, 105, 108], "sourc": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120], "stochast": 3, "gradient": [3, 8, 25], "descent": 3, "would": 3, "data": [3, 4, 5, 6, 10, 19, 20, 22, 23, 24, 25, 34, 38, 61, 64, 87, 116], "parallel": [3, 87], "replic": [3, 18], "them": [3, 25, 28, 64], "subclass": [3, 4, 6, 23, 25, 26, 30], "implement": [3, 5, 6, 7, 20, 22, 23, 25, 26, 57, 105, 107], "train_step": [3, 6, 22, 23, 25], "eval_step": [3, 5, 6, 23], "predict_step": [3, 20, 23, 25], "method": [3, 18, 23, 25, 26, 27, 28, 29, 30, 31, 32, 33, 40, 44, 48, 52, 54, 55, 57, 59, 60, 61, 62, 63, 64, 65, 66, 68, 71, 82, 83, 88, 98, 99, 100, 105, 106, 107, 108], "For": [3, 18, 30, 31, 39, 42, 44, 48, 55, 56, 75, 79], "run": [3, 5, 6, 8, 10, 20, 21, 22, 23, 24, 46, 72, 75, 79, 90, 102, 103, 104, 118, 119, 120], "forward": [3, 57, 71, 72], "backward": [3, 23, 25, 57, 71], "step": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19, 20, 21, 22, 23, 25, 59, 60, 62, 64, 68, 80, 89, 90, 91, 100, 106, 116, 117], "To": [3, 4, 23, 24, 72], "benefit": 3, "must": [3, 7, 8, 18, 25, 54, 55, 65, 72, 87, 100], "compute_loss": [3, 25], "configure_optimizers_and_lr_schedul": [3, 25], "addition": [3, 56], "option": [3, 4, 5, 6, 9, 10, 13, 16, 18, 20, 21, 22, 23, 25, 30, 40, 41, 44, 48, 50, 51, 53, 54, 55, 56, 59, 62, 68, 69, 72, 75, 79, 81, 82, 83, 85, 86, 87, 89, 90, 91, 92, 93, 94, 95, 97, 100, 104, 107, 111, 112, 114, 116], "hook": [3, 4, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 23, 25, 82], "on_train_step_end": [3, 4, 6, 8, 9, 10, 12, 14, 16, 22, 25], "on_eval_step_end": [3, 4, 5, 8, 9, 10, 12, 14, 16], "on_predict_step_end": [3, 4, 7, 8, 9, 10, 12, 14, 16, 20], "Then": [3, 23], "evalu": [3, 4, 6, 8, 10, 13, 14, 16, 18, 21, 23, 24, 25], "predict": [3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 21, 23, 24, 25], "entri": [3, 4, 18, 21, 25, 75], "point": [3, 4, 8, 21, 23, 25, 42, 64], "normal": 3, "advanc": 3, "directli": 3, "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 25, 27, 28, 29, 31, 32, 33, 34, 36, 38, 39, 41, 44, 48, 50, 51, 52, 53, 54, 55, 56, 57, 59, 60, 62, 64, 65, 67, 68, 71, 72, 73, 74, 75, 79, 80, 81, 84, 85, 86, 87, 100, 101, 105, 107, 109, 111, 112, 113, 114, 116], "step_lr_interv": 3, "whether": [3, 15, 18, 21, 38, 54, 59, 71, 100, 105, 107, 114], "lr_schedul": [3, 5, 6, 20, 22, 23, 25], "everi": [3, 8, 15, 18, 19, 25], "default": [3, 7, 8, 13, 15, 16, 18, 23, 26, 29, 30, 32, 38, 41, 44, 46, 47, 48, 51, 53, 55, 56, 59, 64, 66, 68, 75, 79, 84, 105, 107, 111, 112, 114, 116], "precis": [3, 24, 25, 39, 55, 64], "mix": [3, 25], "dtype": [3, 81], "accept": [3, 10, 98], "fp32": 3, "fp16": 3, "bf16": 3, "gradient_accumulation_step": [3, 25], "mani": 3, "batch": [3, 4, 10, 23, 25, 27, 28, 29, 31, 32, 33, 68, 70, 82], "accumul": [3, 25], "over": [3, 23, 25, 27, 29, 30, 31, 32, 33], "detect_anomali": 3, "anomali": [3, 25], "detect": [3, 25], "autograd": 3, "engin": 3, "org": [3, 17, 18, 28, 31, 38, 39, 44, 46, 48, 55, 56, 57, 87], "doc": [3, 17, 28, 38, 39, 44, 46, 48, 55, 56, 87], "stabl": [3, 17, 28, 38, 39, 44, 46, 48, 55, 56, 87], "html": [3, 12, 17, 18, 28, 31, 38, 39, 44, 46, 48, 55, 56, 87], "clip_grad_norm": 3, "max": [3, 5, 6, 20, 22, 54, 116], "norm": [3, 70, 82], "clip": [3, 25], "gener": [3, 4, 8, 13, 18, 30, 31, 38, 39, 56, 64, 67, 72, 73, 87, 110, 113, 114], "util": [3, 5, 6, 9, 13, 17, 18, 20, 22], "clip_grad_norm_": 3, "clip_grad_valu": 3, "clip_grad_value_": 3, "swa_param": 3, "weight": [3, 32, 100], "averag": [3, 9, 100], "torch_compile_param": [3, 87], "compil": [3, 25, 87], "activation_checkpoint_param": [3, 87], "activ": [3, 13, 21, 72, 87], "lr": [3, 25], "creat": [3, 8, 23, 25, 38, 51, 65], "certain": [3, 38, 80], "an": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 20, 21, 22, 23, 25, 26, 28, 30, 48, 53, 54, 64, 74, 75, 78, 81, 84, 85, 86, 101, 108, 116], "through": [3, 30], "well": [3, 50, 68], "swaparam": 3, "swa": [3, 24], "shard": 3, "same": [3, 7, 8, 18, 23, 29, 30, 31, 41, 64, 70, 105], "avail": [3, 18, 35, 45, 49, 53, 55, 75, 79, 80, 105, 107, 114], "0": [3, 16, 18, 25, 27, 29, 32, 33, 45, 46, 48, 50, 53, 54, 56, 59, 60, 62, 64, 65, 82, 88, 92, 93, 94, 95, 96, 97, 100, 106, 109, 111, 112, 118, 119], "higher": 3, "abstract": [3, 23, 24, 25, 26, 60, 63], "tdata": 3, "tupl": [3, 13, 23, 25, 72], "tensor": [3, 23, 25, 27, 29, 32, 33, 38, 41, 72, 80, 82], "ani": [3, 5, 6, 13, 18, 20, 21, 22, 23, 25, 34, 52, 53, 56, 58, 65, 72, 92, 93, 94, 95, 96, 97, 105], "call": [3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 22, 23, 25, 34, 38, 44, 48, 50, 65, 80, 96, 105, 107], "object": [3, 5, 6, 8, 20, 21, 22, 23, 27, 29, 30, 31, 32, 33, 51, 57, 72, 74, 82, 89, 90, 91, 98, 112, 113, 116], "return": [3, 23, 25, 27, 29, 32, 33, 34, 36, 37, 41, 45, 49, 50, 51, 52, 53, 55, 58, 76, 77, 78, 90, 91, 101, 109, 111, 112], "contain": [3, 18, 21, 23, 24, 25, 26, 27, 28, 30, 51, 71, 72, 81], "output": [3, 7, 16, 21, 23, 25, 52, 64, 71, 72, 75, 79, 116], "part": [3, 25], "lrschedul": [3, 98], "construct": [3, 28, 38, 65, 116], "upon": [3, 18], "A": [3, 4, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 27, 29, 30, 31, 32, 33, 36, 40, 48, 52, 57, 66, 67, 72, 80, 91, 105, 107, 109, 111, 112], "requir": [3, 23, 56, 57], "iter": [3, 5, 6, 9, 18, 19, 20, 21, 22, 23, 27, 28, 29, 30, 31, 32, 33, 83, 89, 90, 91, 116], "wish": [3, 23], "decor": [3, 23, 50], "inference_mod": [3, 23], "improv": [3, 8, 23, 54], "metadata": [3, 23], "get_next_eval_batch": [3, 5, 23], "data_it": [3, 23], "union": [3, 4, 7, 9, 10, 11, 15, 16, 17, 18, 19, 23, 27, 29, 30, 31, 32, 33, 51, 53, 56, 82, 84, 87, 98, 116], "next": [3, 4, 10, 23, 29], "input": [3, 23, 25, 29, 51, 53, 56, 71, 109, 111, 112, 113], "otherwis": [3, 8, 23, 38, 45, 49, 100], "overrid": [3, 23], "logic": [3, 4, 23, 30, 31], "get": [3, 4, 16, 23, 31, 35, 36, 37, 44, 45, 46, 47, 48, 49, 118, 119], "get_next_predict_batch": [3, 20, 23], "get_next_train_batch": [3, 6, 22, 23], "int": [3, 5, 6, 8, 9, 13, 16, 18, 20, 21, 22, 25, 26, 28, 44, 45, 46, 48, 49, 52, 53, 54, 56, 59, 60, 62, 64, 67, 69, 74, 75, 82, 83, 88, 89, 90, 91, 101, 105, 115, 116, 117], "none": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 32, 33, 38, 39, 40, 41, 42, 43, 44, 48, 50, 51, 53, 54, 55, 56, 57, 59, 60, 61, 62, 64, 65, 66, 67, 68, 70, 71, 72, 74, 75, 79, 80, 82, 83, 85, 86, 87, 88, 90, 91, 92, 93, 94, 95, 96, 97, 98, 100, 105, 106, 107, 111, 112, 114, 115, 116, 117], "end": [3, 4, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19, 21, 23, 25], "befor": [3, 4, 7, 8, 11, 12, 13, 14, 15, 16, 19, 23, 57, 59, 60, 62, 68, 105, 107], "updat": [3, 8, 16, 18, 24, 25, 100, 115, 117], "log": [3, 9, 11, 13, 15, 17, 18, 19, 24, 25, 59, 60, 61, 62, 64, 65, 92, 93, 94, 95, 97, 105, 107, 114], "metric": [3, 18, 24, 25, 54, 63, 64], "do": [3, 24, 25, 64], "anyth": 3, "els": [3, 50, 59, 60, 62], "been": [3, 27, 33, 55], "complet": [3, 18, 21, 116, 117], "on_train_epoch_end": [3, 4, 6, 10, 16, 17, 19, 22, 23, 25], "note": [3, 12, 51, 56], "rememb": 3, "super": [3, 23, 25], "result": [3, 8, 25, 41, 53, 66, 106, 110], "trainstepresult": [3, 25], "total": [3, 18, 26, 90, 91], "autopredictunit": 3, "str": [3, 4, 7, 11, 13, 18, 25, 27, 29, 30, 31, 32, 33, 36, 37, 39, 44, 47, 48, 51, 52, 53, 55, 56, 58, 59, 60, 62, 65, 68, 72, 73, 75, 79, 81, 84, 87, 98, 109, 110, 111, 112, 113, 114, 116], "torchcompileparam": [3, 87], "bool": [3, 18, 21, 30, 53, 54, 59, 60, 62, 73, 76, 77, 78, 82, 83, 100, 102, 103, 107, 114, 120], "tpredictdata": [3, 4, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 20, 23], "extens": [4, 25], "supplement": [4, 18], "loop": [4, 5, 6, 8, 10, 20, 21, 22, 23, 24, 25, 88, 91, 116], "addit": [4, 18, 23, 25, 38, 105], "good": [4, 64], "candid": 4, "ones": [4, 18], "re": [4, 57, 80], "across": [4, 7, 8, 18, 19, 42, 53, 56, 111, 112], "intend": [4, 25, 26, 55], "go": 4, "write": [4, 7, 19, 38, 59, 60, 62, 65, 79], "add": [4, 42], "below": [4, 5, 6, 20, 22, 23], "exampl": [4, 5, 6, 10, 18, 20, 22, 23, 27, 28, 29, 30, 31, 32, 33, 50, 51, 52, 53, 57, 61, 64, 65, 68, 85, 86, 101, 118, 119], "print": [4, 10, 13, 15, 25, 27, 29, 32, 33, 53, 64, 73, 96], "messag": [4, 16, 78, 92, 93, 94, 95, 97, 116], "variou": [4, 24, 25], "execut": [4, 5, 6, 8, 20, 21, 22, 50, 54, 55], "import": [4, 5, 6, 8, 10, 20, 22, 23, 25, 50, 57, 61, 64, 65, 101], "tevalunit": [4, 25], "tpredictunit": [4, 25], "ttrainunit": [4, 25], "printingcallback": [4, 25], "def": [4, 10, 23, 25, 50], "on_train_start": [4, 6, 8, 10, 13, 14, 18, 19, 22, 23, 25], "self": [4, 23, 25], "start": [4, 7, 8, 10, 11, 13, 14, 15, 16, 18, 19, 21, 23, 25, 68, 100], "on_train_end": [4, 6, 8, 10, 14, 22, 23, 25], "on_eval_start": [4, 5, 8, 10, 13, 14, 23, 25], "on_eval_end": [4, 5, 8, 10, 14, 23, 25], "on_predict_start": [4, 7, 8, 10, 13, 14, 20, 23, 25], "on_predict_end": [4, 7, 8, 10, 14, 20, 23, 25], "instanti": [4, 12, 25, 68], "printing_callback": 4, "train_unit": [4, 22, 23], "properti": [4, 18, 21], "distinct": 4, "per": [4, 5, 6, 20, 21, 22, 64, 105, 107, 116], "instanc": [4, 5, 6, 9, 12, 17, 18, 20, 21, 22, 30, 68, 84, 85, 86, 101], "debug": [4, 21, 25, 93], "profil": [4, 14, 66, 68], "purpos": 4, "tevaldata": [4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 23], "on_eval_epoch_end": [4, 5, 10, 16, 23], "on_eval_epoch_start": [4, 5, 10, 15, 16, 23], "new": [4, 11, 15, 16, 23, 44, 51, 65], "on_eval_get_next_batch_end": [4, 10], "on_eval_step_start": [4, 5, 10, 15], "on_except": [4, 7, 10, 18], "ttraindata": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 22, 23], "exc": [4, 7, 18], "baseexcept": [4, 7, 10, 18, 76, 77, 78], "except": [4, 5, 6, 7, 10, 18, 20, 22, 30, 76, 77, 78], "occur": [4, 7, 10, 18, 19, 75, 100], "on_predict_epoch_end": [4, 10, 16, 20, 23], "on_predict_epoch_start": [4, 10, 15, 16, 20, 23], "on_predict_get_next_batch_end": [4, 10], "on_predict_step_start": [4, 10, 15, 20], "on_train_epoch_start": [4, 6, 10, 11, 15, 16, 22, 23], "on_train_get_next_batch_end": [4, 10], "on_train_step_start": [4, 6, 10, 11, 15, 22], "sever": [4, 23, 25, 41], "pre": 4, "written": [4, 7, 65], "readi": 4, "eval_unit": [5, 23], "eval_dataload": [5, 6, 90], "max_steps_per_epoch": [5, 20, 21, 22, 89, 91, 116], "list": [5, 6, 7, 11, 13, 15, 18, 19, 20, 22, 41, 52, 66, 67, 109, 111], "timer": [5, 6, 20, 21, 22, 24], "timerprotocol": [5, 6, 20, 21, 22, 105, 107, 112, 113], "take": [5, 6, 8, 18, 20, 22], "modifi": [5, 6, 20, 21, 22, 23], "includ": [5, 6, 15, 20, 22, 24, 25, 31, 55, 82, 88], "etc": [5, 6, 13, 18, 20, 22, 25, 30, 31, 52], "number": [5, 6, 8, 16, 18, 20, 21, 22, 26, 28, 41, 44, 48, 52, 54, 56, 59, 60, 62, 64, 71, 75, 89, 90, 91, 100, 101, 105, 107, 116, 117], "mean": [5, 6, 20, 22, 57, 71, 109, 111, 112], "until": [5, 6, 20, 22, 27], "exhaust": [5, 6, 20, 22, 27, 29, 32, 33], "kei": [5, 6, 18, 20, 21, 22, 27, 29, 30, 31, 32, 33, 36, 37, 66], "event": [5, 6, 20, 21, 22, 65, 68, 114], "synchron": [5, 6, 8, 20, 22, 42, 44, 50, 53, 65, 105, 107, 111, 112, 114], "degrad": [5, 6, 20, 22], "myevalunit": [5, 23], "20": [5, 20, 51], "pseudocod": [5, 6, 20, 22], "what": [5, 6, 18, 20, 22, 100], "doe": [5, 6, 8, 20, 22, 80], "first": [5, 6, 20, 22, 24, 52, 80], "while": [5, 6, 20, 22, 27, 33], "try": [5, 6, 20, 22], "increment": [5, 6, 20, 22], "counter": [5, 6, 20, 22, 57], "stopiter": [5, 6, 20, 22], "break": [5, 6, 20, 22], "max_epoch": [6, 21, 22, 25], "max_step": [6, 21, 22, 89, 90, 91, 116], "max_train_steps_per_epoch": [6, 90], "max_eval_steps_per_epoch": [6, 90], "evaluate_every_n_step": [6, 21], "evaluate_every_n_epoch": [6, 21], "interleav": [6, 23, 25, 28], "both": 6, "limit": [6, 22], "infinit": [6, 22, 54], "unless": [6, 22], "stop": [6, 21, 22, 24, 27, 32, 33, 54], "often": 6, "term": [6, 19, 21], "fit_unit": 6, "myfitunit": 6, "4": [6, 22, 27, 29, 32, 33, 53, 64], "header_row": 7, "dir_path": 7, "delimit": 7, "t": [7, 25, 34, 38, 56, 57, 90, 91], "filenam": [7, 44, 79], "csv": [7, 59], "file": [7, 12, 16, 44, 55, 59, 60, 62, 65, 68, 116], "simplifi": [7, 24, 25], "extend": [7, 23], "get_step_output_row": 7, "desir": [7, 50], "row": 7, "all": [7, 8, 12, 13, 18, 25, 27, 29, 31, 32, 41, 42, 51, 53, 59, 60, 62, 65, 113], "match": 7, "column": 7, "defin": [7, 21, 23, 25, 30, 31, 33, 65, 85, 86, 99, 105, 107, 108], "directori": [7, 12, 18, 68, 75, 79], "where": [7, 12, 16, 18, 23, 38, 41, 52, 68, 116], "separ": 7, "tab": 7, "step_interv": 8, "period": [8, 18, 66, 67], "garbag": 8, "collect": [8, 12, 18, 40, 65, 71], "In": [8, 23, 41, 53, 54], "fulli": 8, "program": [8, 35, 38, 55, 120], "multipl": [8, 38, 39, 55, 98], "These": [8, 23, 25, 121], "need": [8, 18, 23, 25, 38, 50, 100, 121], "commun": [8, 18, 48, 52, 82], "other": [8, 18, 53, 106], "especi": [8, 19], "overal": 8, "therefor": 8, "gate": 8, "slowest": 8, "roughli": 8, "amount": 8, "its": [8, 38, 71, 72], "straggler": 8, "python": [8, 56, 102, 103, 118], "trigger": 8, "differ": [8, 18, 23, 24, 25, 41, 64], "possibl": [8, 12], "lead": 8, "frequenc": [8, 9, 18, 21, 25], "tune": 8, "base": [8, 18, 26, 35, 55, 57, 78, 100], "hand": 8, "free": [8, 38, 48, 52, 68], "some": [8, 23, 80], "reap": 8, "minim": 8, "overhead": 8, "compar": 8, "full": 8, "cleanup": 8, "logger": [9, 11, 15, 17, 19, 24, 25, 92, 93, 94, 95, 97], "tensorboardlogg": [9, 17, 25], "summarywrit": [9, 17, 65], "moving_avg_window": 9, "log_every_n_step": [9, 25], "scalar": 9, "tensorboard": [9, 17, 25, 65], "control": [9, 12, 18, 23, 25, 56], "window": [9, 120], "callabl": [10, 13, 50, 52, 82, 83, 104], "retriev": 10, "mydataload": 10, "print_on_step_start": 10, "f": [10, 53], "eval_progress": 10, "num_steps_complet": [10, 25, 88, 89, 115, 116, 117], "lambda_cb": 10, "metriclogg": [11, 15, 19], "logging_interv": [11, 15], "associ": 11, "memory_snapshot_profil": 12, "memorysnapshotprofilerbas": 12, "memori": [12, 15, 24, 28, 38, 61, 68, 75, 79, 80], "snapshot": [12, 18, 68, 75, 79], "pickl": 12, "zdevito": 12, "io": 12, "2022": 12, "08": 12, "16": 12, "recommend": [12, 25, 28], "earli": [12, 24, 54], "ideal": [12, 57, 68], "sure": [12, 24], "alloc": [12, 38, 68, 80], "captur": [12, 66], "max_depth": [13, 74], "process_fn": 13, "module_summari": 13, "_log_module_summary_t": 13, "module_input": [13, 57], "mutablemap": [13, 72], "summari": [13, 24, 71, 74, 113], "maximum": [13, 21, 74, 75], "depth": [13, 74], "tabl": 13, "map": [13, 27, 29, 31, 32, 33, 36, 37, 109, 111, 112], "flop": [13, 24, 71, 72], "size": [13, 15, 26, 41, 49, 66, 67, 71, 72], "rais": [13, 30, 35, 36, 54, 56, 68, 74, 81, 84, 105, 107, 109, 111, 112, 113, 114], "runtimeerror": [13, 35], "torchev": 13, "instal": 13, "context": [14, 35, 57, 67], "manag": [14, 18, 57, 67], "liter": [15, 53, 54, 55, 100], "system": [15, 44, 120], "stat": [15, 25, 36, 37], "cpu": [15, 21, 35, 37, 51, 76], "usag": 15, "resid": [15, 66, 67], "gpu": [15, 35, 36, 105, 107], "refresh_r": [16, 115, 117], "textio": [16, 116], "stringio": [16, 116], "progress": [16, 18, 19, 24, 25, 98, 115, 116, 117], "bar": [16, 115, 116, 117], "visual": [16, 19, 68], "rank": [16, 18, 24, 44, 45, 46, 48, 50, 52, 53, 59, 60, 62, 64, 65, 92, 93, 94, 95, 96, 97, 101, 106, 111, 112], "environ": [16, 24, 35, 44, 46, 48, 55, 65, 119], "determin": [16, 39, 54, 56, 102, 103], "sy": [16, 116], "stderr": [16, 116], "histogram": [17, 109, 111], "writer": 17, "process_group": [18, 82, 83], "processgroup": [18, 40, 41, 53, 82, 83, 106, 111, 112], "async_checkpoint": 18, "storage_opt": 18, "knob_opt": 18, "knobopt": 18, "appstatemixin": 18, "random": [18, 26, 56], "epoch_": 18, "_step_": 18, "parent": [18, 21], "intra": 18, "most": [18, 114], "recent": 18, "excess": 18, "present": 18, "oldest": [18, 105, 107], "delet": 18, "clean": 18, "best": 18, "config": [18, 101], "n": [18, 53], "read": [18, 21, 30, 31], "off": 18, "prior": 18, "entir": 18, "world": [18, 40, 41, 49], "asynchron": [18, 59, 106], "glob": 18, "pattern": 18, "indic": [18, 27, 29, 30, 31, 32, 33, 91], "inform": [18, 21, 39, 44, 48, 51, 55, 71, 73, 75, 79], "see": [18, 25, 39, 44, 48, 55, 56, 75, 79, 100], "api_refer": 18, "safer": 18, "realli": 18, "thing": 18, "grad_scal": 18, "mark": 18, "thei": [18, 64], "unsur": 18, "leav": 18, "field": 18, "unset": 18, "keyword": [18, 34, 65], "storag": 18, "plugin": 18, "document": [18, 30, 31], "knob": 18, "constructor": 18, "oper": [18, 28, 39, 55, 56, 65, 120], "broadcast": [18, 41, 53], "state_dict": [18, 80, 88, 98], "castabl": 18, "maintain": [18, 24, 25], "accuraci": [18, 25, 61, 64, 65], "respons": 18, "reset": [18, 25, 57, 106, 108], "collis": 18, "app": [18, 40], "static": 18, "restor": [18, 80], "skip": [18, 27, 30, 33, 100, 104], "filter": 18, "vs": [19, 73], "predict_unit": [20, 23], "predict_dataload": 20, "mypredictunit": [20, 23], "entry_point": 21, "entrypoint": [21, 101], "train_stat": 21, "eval_st": 21, "predict_st": 21, "phase": [21, 23], "active_phas": 21, "activephas": 21, "current": [21, 35, 53, 55, 72, 89, 91, 118, 119, 120], "One": 21, "meta": 21, "should_stop": 21, "termin": 21, "signal": [21, 54], "record": [21, 38, 68, 75, 109, 110, 111, 112, 113], "latenc": 21, "iteration_tim": 21, "alwai": 21, "without": [21, 54], "synchronis": 21, "step_output": 21, "last": 21, "mytrainunit": [22, 23], "concept": [23, 25], "repres": [23, 25, 82, 83], "primari": [23, 25], "place": [23, 25, 80], "organ": 23, "mutual": [23, 25], "exclus": [23, 25], "e": [23, 25, 73], "g": [23, 25, 73], "case": [23, 25, 41, 53], "allow": [23, 40, 100], "behavior": [23, 105], "fetch": [23, 44, 48], "simpl": [23, 61, 65], "typecheck": 23, "__init__": [23, 25, 26, 27, 28, 29, 30, 31, 32, 33, 40, 54, 57, 59, 60, 61, 62, 63, 64, 65, 66, 68, 71, 82, 83, 88, 98, 99, 100, 105, 106, 107, 108], "_lrschedul": 23, "target": [23, 25], "binary_cross_entropy_with_logit": [23, 25], "zero_grad": [23, 25], "plan": 23, "refer": [23, 30, 31, 42], "my_unit": [23, 25], "librari": [24, 25, 56], "tool": [24, 25], "ha": [24, 25, 27, 30, 31, 33, 54, 55, 113], "two": [24, 25, 33, 70], "compon": [24, 25], "level": [24, 25], "repo": [24, 25], "lightweight": [24, 25], "grab": [24, 25], "bag": [24, 25], "independ": [24, 25, 121], "relat": [24, 25, 76, 77, 121], "wrapper": [24, 25, 40, 98], "publish": [24, 25], "pip": 24, "issu": [24, 40], "version": [24, 100], "just": 24, "git": 24, "upgrad": 24, "checker": 24, "filesystem": [24, 58], "spec": 24, "memorysnapshotprofil": 24, "oom": [24, 68], "prepar": 24, "zero": [24, 68, 80], "test": [24, 52, 104], "tqdm": 24, "misc": 24, "welcom": 25, "descript": [25, 116], "immedi": 25, "infer": [25, 116], "interv": [25, 66, 67, 106], "combin": 25, "myexampleunit": 25, "_modul": 25, "_devic": 25, "_optim": 25, "_log_every_n_step": 25, "_accuraci": 25, "binaryaccuraci": 25, "_tb_logger": 25, "trainer": 25, "our": 25, "task": 25, "copy_data_to_devic": 25, "squeez": 25, "step_count": 25, "train_progress": 25, "acc": 25, "log_dict": [25, 64], "train_accuraci": 25, "train_accuracy_epoch": 25, "predictbatch": 25, "256": 25, "10": [25, 27, 29, 32, 33, 61, 65, 68], "1000": 25, "5": [25, 27, 29, 32, 33, 53, 68], "howev": 25, "don": [25, 56], "necessarili": 25, "themselv": 25, "appli": [25, 100, 105, 107], "tb_logger": 25, "multiclassaccuraci": 25, "gamma": 25, "tlrschedul": 25, "adadelta": 25, "steplr": 25, "step_siz": 25, "nll_loss": 25, "_": 25, "mechan": [25, 27, 32, 33], "inject": 25, "within": [25, 35, 56], "wai": 25, "page": 25, "detail": [25, 30, 31, 56], "suit": 25, "rang": [25, 27, 29, 32, 33, 35, 53, 56, 105, 107, 109, 111, 112], "concret": 26, "_generate_random_item": 26, "produc": 26, "singl": [26, 29, 40, 52, 72, 101], "item": [26, 27, 29, 32, 33], "titem": 26, "individual_dataload": [27, 29, 30, 31, 32, 33], "iteration_strategi": [27, 29, 30, 31, 32, 33], "alldatasetbatch": 27, "all_datasets_exhaust": [27, 32, 33], "finish": 27, "till": [27, 29, 33], "largest": [27, 33], "those": [27, 33], "smallest_dataset_exhaust": [27, 33], "onc": [27, 33, 38, 54], "smallest": [27, 33], "restart_until_all_datasets_exhaust": 27, "restart": 27, "format": [27, 29, 32, 33, 110], "dataloader_1_nam": 27, "batch_obtained_from_dataloader_1": 27, "dataloader_2_nam": 27, "batch_obtained_from_dataloader_2": 27, "loader": [27, 29, 32, 33], "batch_siz": [27, 29, 32, 33], "b": [27, 29, 32, 33], "15": [27, 29, 32, 33], "all_dataset_batch_strategi": 27, "stopping_mechan": [27, 32, 33], "stoppingmechan": [27, 32, 33], "combined_iter": [27, 29, 32, 33], "6": [27, 29, 32, 33], "7": [27, 29, 32, 33], "8": [27, 29, 32, 33, 101, 118], "9": [27, 29, 32, 33], "11": [27, 29, 32, 33], "12": [27, 29, 32, 33, 119], "13": [27, 29, 32, 33, 57, 72], "14": [27, 29, 32, 33], "data_iter": 28, "num_prefetch_batch": 28, "prefetch": 28, "host": [28, 75, 79], "copi": [28, 34, 57, 100], "effect": 28, "leverag": 28, "pin": 28, "data_prefetch": 28, "alreadi": [28, 43, 55, 100], "inord": 29, "order": [29, 31, 33, 64, 106, 114], "overridden": 29, "repetit": 29, "dataloader_nam": [29, 32, 33], "batch_from_dataload": [29, 32, 33], "randomizedbatchsampl": [29, 32], "in_order_strategi": 29, "randomizedbatchsampleriter": 29, "dataiterationstrategi": [30, 31], "iterator_cl": 30, "multiiter": 30, "ignore_empty_data": 30, "cycl": [30, 31, 33], "individu": [30, 31], "dictionari": [30, 105, 107, 109, 111, 112], "torchdata": [30, 31], "multi": [30, 31, 52, 101], "achiev": [30, 31], "mux": [30, 31], "mux_longest": [30, 31], "zip": [30, 31], "pleas": [30, 31, 42], "given": [31, 54, 58, 106, 113, 114], "accompani": 31, "particular": 31, "beta": 31, "randomli": 32, "sampl": [32, 105, 107], "chang": [32, 54], "anoth": [32, 38], "randomized_batch_sampl": 32, "roundrobin": 33, "robinrobin": 33, "round_robin_strategi": 33, "recurs": 34, "posit": [34, 65], "correct": 34, "mp": [35, 52], "reli": [35, 80], "local_rank": [35, 46], "variabl": [35, 46, 65], "made": 35, "launcher": [35, 101], "outsid": [35, 56], "gpustat": 36, "nvidia": 36, "smi": 36, "utilization_gpu_perc": 36, "utilization_memory_perc": 36, "fan_speed_perc": 36, "memory_used_mb": 36, "memory_free_mb": 36, "temperature_gpu_celsiu": 36, "temperature_memory_celsiu": 36, "filenotfounderror": 36, "command": 36, "cpustat": 37, "psutil": 37, "cpu_vm_perc": 37, "cpu_perc": 37, "cpu_swap_perc": 37, "stream": [38, 114], "element": 38, "being": [38, 114], "reus": 38, "mention": 38, "record_stream": 38, "cach": 38, "freed": 38, "newli": 38, "trace": [38, 75], "still": 38, "wa": 38, "tell": 38, "might": [38, 98], "underli": 38, "longer": 38, "creator": 38, "notabl": 38, "trick": 38, "high": [39, 55], "float32": 39, "matrix": [39, 55], "convolut": 39, "set_float32_matmul_precis": 39, "backend": [39, 47, 52, 55], "cudnn": [39, 56], "allow_tf32": 39, "datatyp": 39, "pg": [40, 53, 111, 112], "consist": 40, "fashion": 40, "regardless": 40, "follow": [40, 55, 64, 71], "scenario": 40, "gather": 41, "onto": 41, "dimens": [41, 51], "pad": 41, "trim": 41, "secur": 41, "equal": [41, 55, 68], "workload": 41, "sync": [41, 82, 109, 111, 112], "gathered_result": 41, "i": [41, 52], "correspond": 41, "granular": 42, "pgwrapper": 42, "destroi": 43, "world_siz": [44, 48, 49, 52], "init": [44, 48], "tcp": [44, 48, 55], "protocol": [44, 48, 108], "share": 44, "worker": [44, 48], "get_world_s": [44, 48], "get_global_rank": [44, 48], "temporari": 44, "env": [45, 49], "var": [45, 49], "neither": [45, 49, 68], "condit": [45, 49], "met": [45, 49], "popul": 46, "elast": 46, "hostnam": 48, "port": [48, 52], "address": 48, "belong": [48, 64], "localhost": [48, 52], "select": 48, "fn": 50, "treturn": [50, 52, 104], "judici": 50, "never": 50, "veri": 50, "carefulli": 50, "mutat": 50, "local": 50, "foo": 50, "x": 50, "wrapped_fn": 50, "helper": [51, 110], "convert": [51, 69, 81, 84], "syncbatchnorm": 51, "layer": 51, "batchnorm": 51, "revert": 51, "convert_sync_batchnorm": 51, "origin": 51, "network": 51, "sequenti": 51, "batchnorm1d": 51, "sync_bn_modul": 51, "reverted_modul": 51, "test_method": 52, "test_method_arg": 52, "test_method_kwarg": 52, "spawn": 52, "node": [52, 101], "nccl": 52, "gloo": 52, "l": 52, "val": 53, "coherence_mod": 53, "rank_zero": 53, "boolean": 53, "member": 53, "manner": 53, "receiv": 53, "truth": 53, "integ": [53, 56, 116], "least": 53, "ratio": 53, "synced_v": 53, "iff": 53, "success": [53, 64], "patienc": 54, "min_delta": 54, "check_finit": 54, "threshold_mod": 54, "ab": 54, "rel": 54, "stopping_threshold": 54, "divergence_threshold": 54, "decreas": 54, "increas": 54, "check": [54, 100], "minimum": 54, "absolut": 54, "qualifi": 54, "improvement_threshold": 54, "best_val": 54, "threshold": 54, "becom": 54, "nan": 54, "delta": [54, 66, 67], "between": [54, 70], "beyond": 54, "wors": 54, "than": [54, 68, 74, 105, 107], "valueerror": [54, 56, 68, 74, 81, 84, 105, 107, 109, 111, 112, 113, 114], "device_typ": 55, "dist_init_method_typ": 55, "pg_backend": 55, "pg_timeout": 55, "timedelta": [55, 66, 67, 106], "datetim": [55, 66, 67], "second": [55, 69], "1800": 55, "float32_matmul_precis": 55, "launch": [55, 101], "spmd": 55, "style": [55, 100], "timeout": 55, "against": 55, "30": 55, "minut": 55, "determinist": 56, "pseudo": 56, "commonli": 56, "numpi": 56, "error": [56, 75, 78, 94], "warn": [56, 97], "nondeterminist": 56, "benchmark": 56, "disabl": 56, "set_deterministic_debug_mod": 56, "algorithm": 56, "measur": [57, 66, 67, 106, 114], "count": 57, "dev": 57, "discuss": 57, "dispatch": 57, "505": 57, "torchvis": 57, "resnet18": 57, "randn": 57, "224": 57, "ftdm": 57, "flops_forward": 57, "deepcopi": [57, 100], "flop_count": 57, "flops_backward": 57, "abstractfilesystem": 58, "steps_before_flush": [59, 60, 62], "log_all_rank": [59, 60, 62], "async_writ": 59, "header": 59, "buffer": [59, 61], "flush": [59, 60, 62], "store": [60, 62, 66, 98, 105, 107, 108], "23": [61, 65], "56": [61, 65], "close": [61, 65, 115], "json": 62, "stdout": 64, "line": 64, "were": 64, "treat": 64, "opaqu": 64, "identifi": 64, "consecut": 64, "practic": 64, "digit": 64, "decim": 64, "rule": 64, "round": [64, 66], "usual": 64, "982378": 64, "23112": 64, "payload": 64, "99123": 64, "18787": 64, "9824": 64, "2311": 64, "9912": 64, "1879": 64, "On": 65, "extra": 65, "tmp": [65, 68], "tb_log": 65, "microsecond": [66, 67], "100000": [66, 67, 68], "rss": [66, 67], "baselin": [66, 67], "rss_deltas_byt": 66, "100m": 66, "byte": [66, 67, 71], "rss_delta": 67, "output_dir": [68, 75, 79], "memory_snapshot_param": 68, "memorysnapshotparam": 68, "histori": 68, "dump": 68, "offlin": 68, "stai": 68, "constant": 68, "account": 68, "start_step": 68, "neg": 68, "stop_step": 68, "greater": [68, 72], "nor": 68, "enable_oom_observ": 68, "dai": 69, "src_modul": 70, "dst_modul": 70, "transfer": 70, "statist": 70, "submodul": [71, 72], "trainabl": 71, "estim": [71, 89, 90, 91], "uniniti": 71, "calcul": [71, 72, 90], "shape": 71, "elaps": [71, 106, 114], "ms": 71, "module_arg": 72, "module_kwarg": 72, "modulesummari": [72, 73, 74], "assign": 72, "tree": [72, 74], "summar": 72, "lazi": 72, "NOT": 72, "todo": 72, "flexibl": [72, 100], "human_readable_num": 73, "summary_t": 73, "tabular": [73, 110], "exact": 73, "1234": 73, "k": 73, "prune": 74, "deeper": 74, "prun": 74, "inplac": 74, "root": 74, "trace_max_entri": 75, "1000000": 75, "attach": 75, "blog": [75, 79], "post": [75, 79], "due": 78, "file_prefix": 79, "prefix": 79, "memory_snapshot": 79, "grad": 80, "necessari": [80, 98], "becaus": [80, 98], "adamw": 80, "lazili": 80, "solut": 80, "ensur": [80, 100, 105, 107], "invalid": [81, 84], "output_devic": 82, "dim": 82, "bucket_cap_mb": 82, "25": 82, "find_unused_paramet": [82, 85], "gradient_as_bucket_view": [82, 85], "static_graph": 82, "comm_stat": 82, "comm_hook": 82, "gradbucket": 82, "futur": 82, "sync_batchnorm": 82, "regist": 82, "sharding_strategi": 83, "shardingstrategi": 83, "cpu_offload": 83, "cpuoffload": 83, "auto_wrap_polici": 83, "backward_prefetch": 83, "backwardprefetch": 83, "backward_pr": 83, "mixed_precis": 83, "mixedprecis": 83, "ignored_modul": 83, "param_init_fn": 83, "sync_module_st": 83, "use_orig_param": 83, "state_dict_config": 83, "statedictconfig": 83, "optim_state_dict_config": 83, "optimstatedictconfig": 83, "noopstrategi": 84, "api": [85, 86, 98], "ddp_modul": 85, "fsdp_modul": 86, "activationcheckpointparam": 87, "noop": 87, "num_epochs_complet": [88, 116], "num_steps_completed_in_epoch": 88, "load_state_dict": 88, "remain": 89, "eval_every_n_step": 90, "eval_every_n_epoch": 90, "couldn": [90, 91], "critic": 92, "info": 95, "stateful_obj": 98, "fsdpoptimizerwrapp": 98, "load_checkpoint": 98, "use_buff": 100, "averaging_method": 100, "ema": 100, "ema_decai": 100, "999": 100, "skip_deepcopi": 100, "use_lit": 100, "streamlin": 100, "give": 100, "compat": 100, "swa_util": 100, "l66": 100, "entail": 100, "exponenti": 100, "decai": 100, "ignor": 100, "somewai": 100, "lit": 100, "adjust": 100, "small": 100, "approach": 100, "nproc": 101, "launchconfig": 101, "pet": 101, "launch_config": 101, "elastic_launch": 101, "interpret": [102, 103], "asan": [102, 104], "tsan": 103, "func": 104, "lower_bound": 105, "upper_bound": 105, "recorded_dur": [105, 107, 108, 109, 111], "size_bound": [105, 107], "lower": [105, 107], "upper": [105, 107], "bound": [105, 107], "smaller": [105, 107], "reach": [105, 107], "remov": [105, 107], "action": [105, 107, 109, 111, 112, 113], "cuda_sync": [105, 107, 114], "verbos": [105, 107], "incur": [105, 107], "hit": [105, 107], "accur": [105, 107, 114], "cpu_pg": 106, "propag": 106, "previou": 106, "block": 106, "percentil": [109, 111, 112], "sequenc": [109, 111, 112], "durat": [109, 110, 111, 112], "whose": 112, "action_nam": 114, "progress_bar": [115, 117], "tqdm_asyncio": [115, 116, 117], "desc": 116, "far": 116, "he": 116, "reflect": 117, "runtim": [118, 119], "Is": 120}, "objects": {"torchtnt.framework.auto_unit": [[3, 0, 1, "", "AutoPredictUnit"], [3, 0, 1, "", "AutoUnit"]], "torchtnt.framework.auto_unit.AutoPredictUnit": [[3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "predict_step"]], "torchtnt.framework.auto_unit.AutoUnit": [[3, 1, 1, "", "compute_loss"], [3, 1, 1, "", "configure_optimizers_and_lr_scheduler"], [3, 1, 1, "", "eval_step"], [3, 1, 1, "", "get_next_eval_batch"], [3, 1, 1, "", "get_next_predict_batch"], [3, 1, 1, "", "get_next_train_batch"], [3, 1, 1, "", "on_eval_step_end"], [3, 1, 1, "", "on_predict_step_end"], [3, 1, 1, "", "on_train_epoch_end"], [3, 1, 1, "", "on_train_step_end"], [3, 1, 1, "", "predict_step"], [3, 1, 1, "", "train_step"]], "torchtnt.framework": [[4, 2, 0, "-", "callback"]], "torchtnt.framework.callback": [[4, 0, 1, "", "Callback"]], "torchtnt.framework.callback.Callback": [[4, 3, 1, "", "name"], [4, 1, 1, "", "on_eval_end"], [4, 1, 1, "", "on_eval_epoch_end"], [4, 1, 1, "", "on_eval_epoch_start"], [4, 1, 1, "", "on_eval_get_next_batch_end"], [4, 1, 1, "", "on_eval_start"], [4, 1, 1, "", "on_eval_step_end"], [4, 1, 1, "", "on_eval_step_start"], [4, 1, 1, "", "on_exception"], [4, 1, 1, "", "on_predict_end"], [4, 1, 1, "", "on_predict_epoch_end"], [4, 1, 1, "", "on_predict_epoch_start"], [4, 1, 1, "", "on_predict_get_next_batch_end"], [4, 1, 1, "", "on_predict_start"], [4, 1, 1, "", "on_predict_step_end"], [4, 1, 1, "", "on_predict_step_start"], [4, 1, 1, "", "on_train_end"], [4, 1, 1, "", "on_train_epoch_end"], [4, 1, 1, "", "on_train_epoch_start"], [4, 1, 1, "", "on_train_get_next_batch_end"], [4, 1, 1, "", "on_train_start"], [4, 1, 1, "", "on_train_step_end"], [4, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks": [[7, 0, 1, "", "BaseCSVWriter"], [8, 0, 1, "", "GarbageCollector"], [9, 0, 1, "", "IterationTimeLogger"], [10, 0, 1, "", "Lambda"], [11, 0, 1, "", "LearningRateMonitor"], [12, 0, 1, "", "MemorySnapshot"], [13, 0, 1, "", "ModuleSummary"], [14, 0, 1, "", "PyTorchProfiler"], [15, 0, 1, "", "SystemResourcesMonitor"], [16, 0, 1, "", "TQDMProgressBar"], [17, 0, 1, "", "TensorBoardParameterMonitor"], [18, 0, 1, "", "TorchSnapshotSaver"], [19, 0, 1, "", "TrainProgressMonitor"]], "torchtnt.framework.callbacks.BaseCSVWriter": [[7, 1, 1, "", "on_exception"], [7, 1, 1, "", "on_predict_end"], [7, 1, 1, "", "on_predict_start"], [7, 1, 1, "", "on_predict_step_end"]], "torchtnt.framework.callbacks.GarbageCollector": [[8, 1, 1, "", "on_eval_end"], [8, 1, 1, "", "on_eval_start"], [8, 1, 1, "", "on_eval_step_end"], [8, 1, 1, "", "on_predict_end"], [8, 1, 1, "", "on_predict_start"], [8, 1, 1, "", "on_predict_step_end"], [8, 1, 1, "", "on_train_end"], [8, 1, 1, "", "on_train_start"], [8, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.IterationTimeLogger": [[9, 1, 1, "", "on_eval_step_end"], [9, 1, 1, "", "on_predict_step_end"], [9, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.LearningRateMonitor": [[11, 1, 1, "", "on_train_epoch_start"], [11, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.MemorySnapshot": [[12, 1, 1, "", "on_eval_step_end"], [12, 1, 1, "", "on_predict_step_end"], [12, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.ModuleSummary": [[13, 1, 1, "", "on_eval_start"], [13, 1, 1, "", "on_predict_start"], [13, 1, 1, "", "on_train_start"]], "torchtnt.framework.callbacks.PyTorchProfiler": [[14, 1, 1, "", "on_eval_end"], [14, 1, 1, "", "on_eval_start"], [14, 1, 1, "", "on_eval_step_end"], [14, 1, 1, "", "on_predict_end"], [14, 1, 1, "", "on_predict_start"], [14, 1, 1, "", "on_predict_step_end"], [14, 1, 1, "", "on_train_end"], [14, 1, 1, "", "on_train_start"], [14, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.SystemResourcesMonitor": [[15, 1, 1, "", "on_eval_epoch_start"], [15, 1, 1, "", "on_eval_step_start"], [15, 1, 1, "", "on_predict_epoch_start"], [15, 1, 1, "", "on_predict_step_start"], [15, 1, 1, "", "on_train_epoch_start"], [15, 1, 1, "", "on_train_step_start"]], "torchtnt.framework.callbacks.TQDMProgressBar": [[16, 1, 1, "", "on_eval_epoch_end"], [16, 1, 1, "", "on_eval_epoch_start"], [16, 1, 1, "", "on_eval_step_end"], [16, 1, 1, "", "on_predict_epoch_end"], [16, 1, 1, "", "on_predict_epoch_start"], [16, 1, 1, "", "on_predict_step_end"], [16, 1, 1, "", "on_train_epoch_end"], [16, 1, 1, "", "on_train_epoch_start"], [16, 1, 1, "", "on_train_step_end"]], "torchtnt.framework.callbacks.TensorBoardParameterMonitor": [[17, 1, 1, "", "on_train_epoch_end"]], "torchtnt.framework.callbacks.TorchSnapshotSaver": [[18, 1, 1, "", "on_exception"], [18, 1, 1, "", "on_train_start"], [18, 1, 1, "", "restore"]], "torchtnt.framework.callbacks.TrainProgressMonitor": [[19, 1, 1, "", "on_train_epoch_end"], [19, 1, 1, "", "on_train_start"]], "torchtnt.framework.evaluate": [[5, 4, 1, "", "evaluate"]], "torchtnt.framework.fit": [[6, 4, 1, "", "fit"]], "torchtnt.framework.predict": [[20, 4, 1, "", "predict"]], "torchtnt.framework.state": [[21, 0, 1, "", "PhaseState"], [21, 0, 1, "", "State"]], "torchtnt.framework.state.PhaseState": [[21, 3, 1, "", "dataloader"], [21, 3, 1, "", "evaluate_every_n_epochs"], [21, 3, 1, "", "evaluate_every_n_steps"], [21, 3, 1, "", "iteration_timer"], [21, 3, 1, "", "max_epochs"], [21, 3, 1, "", "max_steps"], [21, 3, 1, "", "max_steps_per_epoch"], [21, 3, 1, "", "step_output"]], "torchtnt.framework.state.State": [[21, 3, 1, "", "active_phase"], [21, 3, 1, "", "entry_point"], [21, 3, 1, "", "eval_state"], [21, 3, 1, "", "predict_state"], [21, 3, 1, "", "should_stop"], [21, 1, 1, "", "stop"], [21, 3, 1, "", "timer"], [21, 3, 1, "", "train_state"]], "torchtnt.framework.train": [[22, 4, 1, "", "train"]], "torchtnt.framework.unit": [[23, 0, 1, "", "EvalUnit"], [23, 0, 1, "", "PredictUnit"], [23, 0, 1, "", "TrainUnit"]], "torchtnt.framework.unit.EvalUnit": [[23, 1, 1, "", "eval_step"], [23, 1, 1, "", "get_next_eval_batch"], [23, 1, 1, "", "on_eval_end"], [23, 1, 1, "", "on_eval_epoch_end"], [23, 1, 1, "", "on_eval_epoch_start"], [23, 1, 1, "", "on_eval_start"]], "torchtnt.framework.unit.PredictUnit": [[23, 1, 1, "", "get_next_predict_batch"], [23, 1, 1, "", "on_predict_end"], [23, 1, 1, "", "on_predict_epoch_end"], [23, 1, 1, "", "on_predict_epoch_start"], [23, 1, 1, "", "on_predict_start"], [23, 1, 1, "", "predict_step"]], "torchtnt.framework.unit.TrainUnit": [[23, 1, 1, "", "get_next_train_batch"], [23, 1, 1, "", "on_train_end"], [23, 1, 1, "", "on_train_epoch_end"], [23, 1, 1, "", "on_train_epoch_start"], [23, 1, 1, "", "on_train_start"], [23, 1, 1, "", "train_step"]], "torchtnt.utils.data": [[26, 0, 1, "", "AbstractRandomDataset"], [27, 0, 1, "", "AllDatasetBatchesIterator"], [28, 0, 1, "", "CudaDataPrefetcher"], [29, 0, 1, "", "InOrderIterator"], [30, 0, 1, "", "MultiDataLoader"], [31, 0, 1, "", "MultiIterator"], [32, 0, 1, "", "RandomizedBatchSamplerIterator"], [33, 0, 1, "", "RoundRobinIterator"]], "torchtnt.utils.data.AbstractRandomDataset": [[26, 1, 1, "", "__init__"], [26, 5, 1, "", "size"]], "torchtnt.utils.data.AllDatasetBatchesIterator": [[27, 1, 1, "", "__init__"]], "torchtnt.utils.data.CudaDataPrefetcher": [[28, 1, 1, "", "__init__"]], "torchtnt.utils.data.InOrderIterator": [[29, 1, 1, "", "__init__"]], "torchtnt.utils.data.MultiDataLoader": [[30, 1, 1, "", "__init__"], [30, 5, 1, "", "ignore_empty_data"], [30, 5, 1, "", "individual_dataloaders"], [30, 5, 1, "", "iteration_strategy"], [30, 5, 1, "", "iterator_cls"]], "torchtnt.utils.data.MultiIterator": [[31, 1, 1, "", "__init__"]], "torchtnt.utils.data.RandomizedBatchSamplerIterator": [[32, 1, 1, "", "__init__"]], "torchtnt.utils.data.RoundRobinIterator": [[33, 1, 1, "", "__init__"]], "torchtnt.utils.device": [[34, 4, 1, "", "copy_data_to_device"], [35, 4, 1, "", "get_device_from_env"], [36, 4, 1, "", "get_nvidia_smi_gpu_stats"], [37, 4, 1, "", "get_psutil_cpu_stats"], [38, 4, 1, "", "record_data_in_stream"], [39, 4, 1, "", "set_float32_precision"]], "torchtnt.utils.distributed": [[40, 0, 1, "", "PGWrapper"], [41, 4, 1, "", "all_gather_tensors"], [42, 4, 1, "", "barrier"], [43, 4, 1, "", "destroy_process_group"], [44, 4, 1, "", "get_file_init_method"], [45, 4, 1, "", "get_global_rank"], [46, 4, 1, "", "get_local_rank"], [47, 4, 1, "", "get_process_group_backend_from_device"], [48, 4, 1, "", "get_tcp_init_method"], [49, 4, 1, "", "get_world_size"], [50, 4, 1, "", "rank_zero_fn"], [51, 4, 1, "", "revert_sync_batchnorm"], [52, 4, 1, "", "spawn_multi_process"], [53, 4, 1, "", "sync_bool"]], "torchtnt.utils.distributed.PGWrapper": [[40, 1, 1, "", "__init__"]], "torchtnt.utils.early_stop_checker": [[54, 0, 1, "", "EarlyStopChecker"]], "torchtnt.utils.early_stop_checker.EarlyStopChecker": [[54, 1, 1, "", "__init__"]], "torchtnt.utils.env": [[55, 4, 1, "", "init_from_env"], [56, 4, 1, "", "seed"]], "torchtnt.utils.flops": [[57, 0, 1, "", "FlopTensorDispatchMode"]], "torchtnt.utils.flops.FlopTensorDispatchMode": [[57, 1, 1, "", "__init__"]], "torchtnt.utils.fsspec": [[58, 4, 1, "", "get_filesystem"]], "torchtnt.utils.loggers": [[59, 0, 1, "", "CSVLogger"], [60, 0, 1, "", "FileLogger"], [61, 0, 1, "", "InMemoryLogger"], [62, 0, 1, "", "JSONLogger"], [63, 0, 1, "", "MetricLogger"], [64, 0, 1, "", "StdoutLogger"], [65, 0, 1, "", "TensorBoardLogger"]], "torchtnt.utils.loggers.CSVLogger": [[59, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.FileLogger": [[60, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.InMemoryLogger": [[61, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.JSONLogger": [[62, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.MetricLogger": [[63, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.StdoutLogger": [[64, 1, 1, "", "__init__"]], "torchtnt.utils.loggers.TensorBoardLogger": [[65, 1, 1, "", "__init__"]], "torchtnt.utils.memory": [[66, 0, 1, "", "RSSProfiler"], [67, 4, 1, "", "measure_rss_deltas"]], "torchtnt.utils.memory.RSSProfiler": [[66, 1, 1, "", "__init__"], [66, 5, 1, "", "interval"], [66, 5, 1, "", "rss_deltas_bytes"]], "torchtnt.utils.memory_snapshot_profiler": [[68, 0, 1, "", "MemorySnapshotProfiler"]], "torchtnt.utils.memory_snapshot_profiler.MemorySnapshotProfiler": [[68, 1, 1, "", "__init__"]], "torchtnt.utils.misc": [[69, 4, 1, "", "days_to_secs"], [70, 4, 1, "", "transfer_batch_norm_stats"]], "torchtnt.utils.module_summary": [[71, 0, 1, "", "ModuleSummary"], [72, 4, 1, "", "get_module_summary"], [73, 4, 1, "", "get_summary_table"], [74, 4, 1, "", "prune_module_summary"]], "torchtnt.utils.module_summary.ModuleSummary": [[71, 1, 1, "", "__init__"]], "torchtnt.utils.oom": [[75, 4, 1, "", "attach_oom_observer"], [76, 4, 1, "", "is_out_of_cpu_memory"], [77, 4, 1, "", "is_out_of_cuda_memory"], [78, 4, 1, "", "is_out_of_memory_error"], [79, 4, 1, "", "log_memory_snapshot"]], "torchtnt.utils.optimizer": [[80, 4, 1, "", "init_optim_state"]], "torchtnt.utils.precision": [[81, 4, 1, "", "convert_precision_str_to_dtype"]], "torchtnt.utils.prepare_module": [[82, 0, 1, "", "DDPStrategy"], [83, 0, 1, "", "FSDPStrategy"], [84, 4, 1, "", "convert_str_to_strategy"], [85, 4, 1, "", "prepare_ddp"], [86, 4, 1, "", "prepare_fsdp"], [87, 4, 1, "", "prepare_module"]], "torchtnt.utils.prepare_module.DDPStrategy": [[82, 1, 1, "", "__init__"]], "torchtnt.utils.prepare_module.FSDPStrategy": [[83, 1, 1, "", "__init__"]], "torchtnt.utils.progress": [[88, 0, 1, "", "Progress"], [89, 4, 1, "", "estimated_steps_in_epoch"], [90, 4, 1, "", "estimated_steps_in_fit"], [91, 4, 1, "", "estimated_steps_in_loop"]], "torchtnt.utils.progress.Progress": [[88, 1, 1, "", "__init__"]], "torchtnt.utils.rank_zero_log": [[92, 4, 1, "", "rank_zero_critical"], [93, 4, 1, "", "rank_zero_debug"], [94, 4, 1, "", "rank_zero_error"], [95, 4, 1, "", "rank_zero_info"], [96, 4, 1, "", "rank_zero_print"], [97, 4, 1, "", "rank_zero_warn"]], "torchtnt.utils.stateful": [[98, 0, 1, "", "MultiStateful"], [99, 0, 1, "", "Stateful"]], "torchtnt.utils.stateful.MultiStateful": [[98, 1, 1, "", "__init__"]], "torchtnt.utils.stateful.Stateful": [[99, 1, 1, "", "__init__"]], "torchtnt.utils.swa": [[100, 0, 1, "", "AveragedModel"]], "torchtnt.utils.swa.AveragedModel": [[100, 1, 1, "", "__init__"]], "torchtnt.utils.test_utils": [[101, 4, 1, "", "get_pet_launch_config"], [102, 4, 1, "", "is_asan"], [103, 4, 1, "", "is_tsan"], [104, 4, 1, "", "skip_if_asan"]], "torchtnt.utils.timer": [[105, 0, 1, "", "BoundedTimer"], [106, 0, 1, "", "FullSyncPeriodicTimer"], [107, 0, 1, "", "Timer"], [108, 0, 1, "", "TimerProtocol"], [109, 4, 1, "", "get_durations_histogram"], [110, 4, 1, "", "get_recorded_durations_table"], [111, 4, 1, "", "get_synced_durations_histogram"], [112, 4, 1, "", "get_synced_timer_histogram"], [113, 4, 1, "", "get_timer_summary"], [114, 4, 1, "", "log_elapsed_time"]], "torchtnt.utils.timer.BoundedTimer": [[105, 1, 1, "", "__init__"]], "torchtnt.utils.timer.FullSyncPeriodicTimer": [[106, 1, 1, "", "__init__"]], "torchtnt.utils.timer.Timer": [[107, 1, 1, "", "__init__"]], "torchtnt.utils.timer.TimerProtocol": [[108, 1, 1, "", "__init__"]], "torchtnt.utils.tqdm": [[115, 4, 1, "", "close_progress_bar"], [116, 4, 1, "", "create_progress_bar"], [117, 4, 1, "", "update_progress_bar"]], "torchtnt.utils.version": [[118, 4, 1, "", "get_python_version"], [119, 4, 1, "", "get_torch_version"], [120, 4, 1, "", "is_windows"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:module", "3": "py:property", "4": "py:function", "5": "py:attribute"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "module", "Python module"], "3": ["py", "property", "Python property"], "4": ["py", "function", "Python function"], "5": ["py", "attribute", "Python attribute"]}, "titleterms": {"checkpoint": 0, "fulli": [0, 1], "shard": [0, 1], "data": [0, 1, 26, 27, 28, 29, 30, 31, 32, 33, 121], "parallel": [0, 1], "finetun": 0, "best": 0, "model": [0, 25], "metric": 0, "distribut": [1, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 121], "train": [1, 2, 22, 25], "exampl": [2, 24], "trainunit": [2, 23], "autounit": [2, 3], "torchdata": 2, "mnist": 2, "mingpt": 2, "torchrec": 2, "callback": [4, 25], "built": 4, "evalu": 5, "entri": [5, 6, 20, 22], "point": [5, 6, 20, 22], "fit": 6, "basecsvwrit": 7, "garbagecollector": 8, "iterationtimelogg": 9, "lambda": 10, "learningratemonitor": 11, "memorysnapshot": 12, "modulesummari": [13, 71], "pytorchprofil": 14, "systemresourcesmonitor": 15, "tqdmprogressbar": 16, "tensorboardparametermonitor": 17, "torchsnapshotsav": 18, "trainprogressmonitor": 19, "predict": 20, "state": [21, 98, 99, 121], "phasest": 21, "unit": 23, "evalunit": 23, "predictunit": 23, "combin": 23, "multipl": 23, "welcom": 24, "torchtnt": [24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120], "document": 24, "instal": 24, "overview": [24, 25], "core": [24, 25], "concept": 24, "framework": [24, 25], "util": [24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121], "function": 25, "api": 25, "organ": 25, "your": 25, "code": 25, "abstractrandomdataset": 26, "alldatasetbatchesiter": 27, "cudadataprefetch": 28, "inorderiter": 29, "multidataload": 30, "multiiter": 31, "randomizedbatchsampleriter": 32, "roundrobiniter": 33, "devic": [34, 35, 36, 37, 38, 39, 121], "copy_data_to_devic": 34, "get_device_from_env": 35, "get_nvidia_smi_gpu_stat": 36, "get_psutil_cpu_stat": 37, "record_data_in_stream": 38, "set_float32_precis": 39, "pgwrapper": 40, "all_gather_tensor": 41, "barrier": 42, "destroy_process_group": 43, "get_file_init_method": 44, "get_global_rank": 45, "get_local_rank": 46, "get_process_group_backend_from_devic": 47, "get_tcp_init_method": 48, "get_world_s": 49, "rank_zero_fn": 50, "revert_sync_batchnorm": 51, "spawn_multi_process": 52, "sync_bool": 53, "early_stop_check": 54, "earlystopcheck": 54, "env": [55, 56], "init_from_env": 55, "seed": 56, "flop": [57, 121], "floptensordispatchmod": 57, "fsspec": 58, "get_filesystem": 58, "logger": [59, 60, 61, 62, 63, 64, 65, 121], "csvlogger": 59, "filelogg": 60, "inmemorylogg": 61, "jsonlogg": 62, "metriclogg": 63, "stdoutlogg": 64, "tensorboardlogg": 65, "memori": [66, 67, 121], "rssprofil": 66, "measure_rss_delta": 67, "memory_snapshot_profil": 68, "memorysnapshotprofil": [68, 121], "misc": [69, 70, 121], "days_to_sec": 69, "transfer_batch_norm_stat": 70, "module_summari": [71, 72, 73, 74], "get_module_summari": 72, "get_summary_t": 73, "prune_module_summari": 74, "oom": [75, 76, 77, 78, 79, 121], "attach_oom_observ": 75, "is_out_of_cpu_memori": 76, "is_out_of_cuda_memori": 77, "is_out_of_memory_error": 78, "log_memory_snapshot": 79, "optim": [80, 121], "init_optim_st": 80, "precis": [81, 121], "convert_precision_str_to_dtyp": 81, "prepare_modul": [82, 83, 84, 85, 86, 87], "ddpstrategi": 82, "fsdpstrategi": 83, "convert_str_to_strategi": 84, "prepare_ddp": 85, "prepare_fsdp": 86, "progress": [88, 89, 90, 91, 121], "estimated_steps_in_epoch": 89, "estimated_steps_in_fit": 90, "estimated_steps_in_loop": 91, "rank_zero_log": [92, 93, 94, 95, 96, 97], "rank_zero_crit": 92, "rank_zero_debug": 93, "rank_zero_error": 94, "rank_zero_info": 95, "rank_zero_print": 96, "rank_zero_warn": 97, "multist": 98, "swa": [100, 121], "averagedmodel": 100, "test_util": [101, 102, 103, 104], "get_pet_launch_config": 101, "is_asan": 102, "is_tsan": 103, "skip_if_asan": 104, "timer": [105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 121], "boundedtim": 105, "fullsyncperiodictim": 106, "timerprotocol": 108, "get_durations_histogram": 109, "get_recorded_durations_t": 110, "get_synced_durations_histogram": 111, "get_synced_timer_histogram": 112, "get_timer_summari": 113, "log_elapsed_tim": 114, "tqdm": [115, 116, 117, 121], "close_progress_bar": 115, "create_progress_bar": 116, "update_progress_bar": 117, "version": [118, 119, 120, 121], "get_python_vers": 118, "get_torch_vers": 119, "is_window": 120, "earli": 121, "stop": 121, "checker": 121, "environ": 121, "filesystem": 121, "spec": 121, "modul": 121, "summari": 121, "prepar": 121, "rank": 121, "zero": 121, "log": 121, "test": 121}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.viewcode": 1, "sphinx.ext.intersphinx": 1, "sphinx": 56}})